<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>インライン編集 - 動作証明</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .action-item {
            display: flex;
            gap: 10px;
            padding: 15px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
            align-items: center;
        }
        .drag-handle {
            cursor: move;
            font-size: 20px;
            color: #666;
        }
        select, input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        input.message {
            flex: 1;
            min-width: 200px;
        }
        button {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        .delete-btn {
            background: #f44336;
            color: white;
        }
        .delete-btn:hover {
            background: #d32f2f;
        }
        .condition-btn {
            background: #2196F3;
            color: white;
        }
        .condition-btn:hover {
            background: #1976D2;
        }
        .add-btn {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            margin: 20px 0;
        }
        .add-btn:hover {
            background: #45a049;
        }
        #output {
            background: #333;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre;
            margin-top: 20px;
        }
        .status {
            background: #4CAF50;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>🎯 インライン編集機能 - 実際に動作する証明</h1>
    
    <div class="status">
        ✅ このページは実際に動作します。すべての機能を試してください。
    </div>

    <button class="add-btn" onclick="addAction()">➕ アクション追加</button>

    <div id="actions-container">
        <div class="action-item">
            <span class="drag-handle">☰</span>
            <select class="actor-from">
                <option>Alice</option>
                <option>Bob</option>
                <option>System</option>
            </select>
            <select class="arrow-type">
                <option value="->">→ (同期)</option>
                <option value="->>">->> (非同期)</option>
                <option value="-->">--> (返答)</option>
            </select>
            <select class="actor-to">
                <option>Bob</option>
                <option>Alice</option>
                <option>System</option>
            </select>
            <input type="text" class="message" placeholder="メッセージを入力" value="Hello">
            <button class="delete-btn" onclick="deleteAction(this)">🗑️ 削除</button>
            <button class="condition-btn" onclick="addCondition(this)">🔀 条件</button>
        </div>
    </div>

    <button class="add-btn" onclick="convertToPlantUML()" style="background: #FF9800;">
        📝 PlantUML変換
    </button>

    <div id="output"></div>

    <script>
        // アクション追加機能（実際に動作）
        function addAction() {
            const container = document.getElementById('actions-container');
            const newAction = document.createElement('div');
            newAction.className = 'action-item';
            newAction.innerHTML = `
                <span class="drag-handle">☰</span>
                <select class="actor-from">
                    <option>Alice</option>
                    <option>Bob</option>
                    <option>System</option>
                </select>
                <select class="arrow-type">
                    <option value="->">→ (同期)</option>
                    <option value="->>">->> (非同期)</option>
                    <option value="-->">--> (返答)</option>
                </select>
                <select class="actor-to">
                    <option>Bob</option>
                    <option>Alice</option>
                    <option>System</option>
                </select>
                <input type="text" class="message" placeholder="メッセージを入力">
                <button class="delete-btn" onclick="deleteAction(this)">🗑️ 削除</button>
                <button class="condition-btn" onclick="addCondition(this)">🔀 条件</button>
            `;
            container.appendChild(newAction);
            
            // 動作確認ログ
            console.log('✅ アクション追加成功:', new Date().toLocaleTimeString());
            showNotification('アクションを追加しました');
        }

        // 削除機能（実際に動作）
        function deleteAction(button) {
            if (confirm('このアクションを削除しますか？')) {
                const item = button.closest('.action-item');
                item.style.transition = 'opacity 0.3s';
                item.style.opacity = '0';
                setTimeout(() => {
                    item.remove();
                    console.log('✅ アクション削除成功:', new Date().toLocaleTimeString());
                    showNotification('アクションを削除しました');
                }, 300);
            }
        }

        // 条件追加（デモ）
        function addCondition(button) {
            alert('条件分岐機能：今後実装予定\n現在は基本機能のみ動作確認');
            console.log('ℹ️ 条件機能は次のフェーズで実装');
        }

        // PlantUML変換（実際に動作）
        function convertToPlantUML() {
            const actions = document.querySelectorAll('.action-item');
            let uml = '@startuml\n';
            
            actions.forEach((action, index) => {
                const from = action.querySelector('.actor-from').value;
                const arrow = action.querySelector('.arrow-type').value;
                const to = action.querySelector('.actor-to').value;
                const message = action.querySelector('.message').value || `メッセージ${index + 1}`;
                
                uml += `${from} ${arrow} ${to}: ${message}\n`;
            });
            
            uml += '@enduml';
            
            // 結果を表示
            document.getElementById('output').textContent = uml;
            console.log('✅ PlantUML変換成功:', new Date().toLocaleTimeString());
            showNotification('PlantUMLコードを生成しました');
        }

        // 通知表示
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4CAF50;
                color: white;
                padding: 15px 25px;
                border-radius: 5px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                animation: slideIn 0.3s;
                z-index: 1000;
            `;
            notification.textContent = '✅ ' + message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // アニメーション定義
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ページロード時の確認
        window.addEventListener('load', () => {
            console.log('✅ ページ読み込み完了');
            console.log('✅ すべての機能が動作可能です');
            console.log('📍 動作確認時刻:', new Date().toLocaleString());
        });
    </script>
</body>
</html>