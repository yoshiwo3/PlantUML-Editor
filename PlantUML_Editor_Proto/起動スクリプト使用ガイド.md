# PlantUML Editor Proto - 起動スクリプト使用ガイド

## 📋 概要

PlantUML Editor Protoを簡単に起動するための4つのスクリプトファイルが用意されています。CORS（Cross-Origin Resource Sharing）エラーを回避し、正常にアプリケーションを動作させるためのツールです。

## 🚀 利用可能なスクリプト

### 1. start_server.bat （標準版）
**最も基本的な起動スクリプト**

**特徴:**
- シンプルで軽量
- Python HTTP Serverを使用
- ポート8080固定
- 初心者向け

**使用方法:**
```batch
ダブルクリックで実行
```

**適用場面:**
- 初回試用時
- 簡単な動作確認
- 軽量な環境での使用

---

### 2. start-app.bat （基本版）
**機能強化された基本スクリプト**

**特徴:**
- Python環境の自動確認
- ポート使用状況のチェック
- 代替ポートの提案
- 詳細なエラーメッセージ
- ファイル存在確認
- 健全性チェック

**使用方法:**
```batch
start-app.bat をダブルクリック
```

**適用場面:**
- 日常的な開発作業
- 複数のポートが使用される環境
- より安定した起動が必要な場合

---

### 3. start-app.ps1 （PowerShell版）
**PowerShellによる高機能版**

**特徴:**
- Node.js/npm の自動検出
- HTTPサーバーの選択機能
- ポート自動検索（8080-8090）
- 詳細なログ出力
- 実行時間の記録
- バックグラウンド実行対応

**使用方法:**
```powershell
# PowerShellで実行
.\start-app.ps1

# または右クリック → PowerShellで実行
```

**前提条件:**
- PowerShell実行ポリシーの設定が必要な場合があります
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

**適用場面:**
- 複数の開発環境を持つユーザー
- ログ記録が必要な場合
- Node.js環境も利用したい場合

---

### 4. start-app-advanced.bat （高機能版）
**最も高機能なスクリプト**

**特徴:**
- 複数HTTPサーバー対応（Python/Node.js/npm）
- 自動システム診断
- 詳細なログ記録
- ポート自動検索（8080-8090）
- 管理者権限の確認
- トラブルシューティング機能
- 診断モード搭載

**使用方法:**
```batch
start-app-advanced.bat をダブルクリック
```

**高度な機能:**
- **診断モード**: システム環境の詳細レポート
- **自動ログ**: 実行履歴の自動記録
- **マルチサーバー**: 最適なHTTPサーバーを自動選択

**適用場面:**
- プロダクション環境
- トラブルシューティングが必要な場合
- 詳細な実行ログが必要な場合
- 複数の開発ツールを使用する環境

---

## 🛠️ トラブルシューティング

### よくある問題と解決方法

#### 1. Pythonが見つからないエラー
```
❌ Pythonがインストールされていません
```

**解決方法:**
1. [Python公式サイト](https://www.python.org) からダウンロード
2. インストール時に「Add Python to PATH」をチェック
3. コマンドプロンプトを再起動

#### 2. ポートが使用中のエラー
```
⚠️ ポート8080は既に使用中です
```

**解決方法:**
- **start-app.bat** または **start-app-advanced.bat** を使用
- これらのスクリプトが自動的に代替ポートを提案します

#### 3. PowerShell実行ポリシーエラー
```
このシステムではスクリプトの実行が無効になっています
```

**解決方法:**
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

#### 4. ウイルス対策ソフトの警告
**対処法:**
1. Windows Defenderの除外設定に追加
2. 一時的にリアルタイム保護を無効化
3. 管理者として実行

#### 5. CORSエラーが表示される
```
CORS policy: Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https
```

**これは正常です！**
- HTTPサーバー経由でアクセスしているため、CORSエラーは発生しません
- file://プロトコルで直接HTMLを開いた場合にのみ発生

---

## 🔧 システム要件

### 必須要件
- **OS**: Windows 10/11
- **Python**: 3.6以上 (推奨: 3.8以上)
- **ブラウザ**: Chrome, Firefox, Edge (最新版)

### 推奨要件
- **Node.js**: 14.0以上 (start-app.ps1, start-app-advanced.bat で高機能を利用)
- **npm**: 6.0以上
- **PowerShell**: 5.1以上 (start-app.ps1 使用時)

---

## 📊 スクリプト選択ガイド

| 使用場面 | 推奨スクリプト | 理由 |
|---------|---------------|------|
| **初回試用** | start_server.bat | 最もシンプル |
| **日常開発** | start-app.bat | バランスの良い機能 |
| **複数環境** | start-app.ps1 | Node.js/Python両対応 |
| **トラブル時** | start-app-advanced.bat | 詳細診断機能 |
| **プロダクション** | start-app-advanced.bat | 最高レベルの安定性 |

---

## 🔒 セキュリティ注意事項

### Windows Defender
- スクリプトファイルが初回実行時に警告される場合があります
- 「詳細情報」→ 「実行」で許可してください

### ファイアウォール
- HTTPサーバー起動時にファイアウォール警告が表示される場合があります
- 「プライベートネットワーク」のみ許可することを推奨

### ポート開放
- ローカルホスト（127.0.0.1）のみでアクセス
- 外部からのアクセスは自動的にブロックされます

---

## 📚 ログファイル

### 自動生成されるログ
- **start-app.ps1**: `start-app-log-YYYYMMDD-HHMMSS.txt`
- **start-app-advanced.bat**: `start-app-log-YYYYMMDD-HHMMSS.txt`

### ログの内容
- 起動時刻/終了時刻
- 使用したHTTPサーバー
- ポート番号
- システム情報
- エラー情報

---

## 🆘 サポート

### 問題が解決しない場合
1. **診断モードを実行**
   ```batch
   start-app-advanced.bat
   # 最後のオプション「診断モード」を選択
   ```

2. **ログファイルを確認**
   - 生成されたログファイルを開いて内容を確認

3. **手動確認**
   ```batch
   # Python確認
   python --version
   
   # ポート確認
   netstat -an | find "8080"
   
   # ファイル確認
   dir index.html app.js styles.css
   ```

### 開発者向け情報
- **スクリプトバージョン**: 2.0
- **対応OS**: Windows 10/11
- **テスト環境**: Python 3.8-3.11, Node.js 16-18
- **最終更新**: 2025年8月13日

---

## 📈 更新履歴

| バージョン | 日付 | 更新内容 |
|-----------|------|----------|
| 2.0 | 2025-08-13 | 高機能スクリプト追加、CORS対策完了 |
| 1.1 | 2025-08-12 | PowerShell版追加 |
| 1.0 | 2025-08-11 | 基本版作成 |

---

**🎯 このガイドにより、どなたでも簡単にPlantUML Editor Protoを起動できます！**