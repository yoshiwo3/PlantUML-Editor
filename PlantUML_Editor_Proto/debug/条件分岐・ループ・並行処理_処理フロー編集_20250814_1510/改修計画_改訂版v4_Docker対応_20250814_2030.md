# æ¡ä»¶åˆ†å²ãƒ»ãƒ«ãƒ¼ãƒ—ãƒ»ä¸¦è¡Œå‡¦ç† ç·¨é›†æ©Ÿèƒ½ åŒ…æ‹¬çš„æ”¹ä¿®è¨ˆç”»æ›¸ v4.0 Dockeræ¨™æº–åŒ–ç‰ˆ

**ä½œæˆæ—¥æ™‚**: 2025-08-14 20:30  
**ä½œæˆè€…**: ai-driven-app-architect + web-debug-specialist  
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: C:\d\PlantUML\PlantUML_Editor_Proto\app.js  
**æº–æ‹ åŸºæº–**: CLAUDE.md v3.0ï¼ˆDockeræ¨™æº–ãƒ†ã‚¹ãƒˆç’°å¢ƒå®šç¾©æº–æ‹ ï¼‰

## ğŸ“Œ ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

èª¿æŸ»å ±å‘Šæ›¸ï¼ˆ2025-08-14 16:05-16:25ï¼‰ã«ã‚ˆã‚Šåˆ¤æ˜ã—ãŸç·¨é›†æ©Ÿèƒ½ã®æœªå®Ÿè£…å•é¡Œã«å¯¾ã—ã€**CLAUDE.mdã®Dockeræ¨™æº–ãƒ†ã‚¹ãƒˆç’°å¢ƒå®šç¾©**ã«å®Œå…¨æº–æ‹ ã—ãŸæ”¹ä¿®è¨ˆç”»v4.0ã‚’ç­–å®šã€‚20æ—¥é–“ã®ç¾å®Ÿçš„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€Dockerç’°å¢ƒã§ã®åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã€CI/CDå®Œå…¨çµ±åˆã‚’å®Ÿç¾ã€‚

### ğŸ”„ æ”¹è¨‚å±¥æ­´
- v1.0 (16:30): åˆç‰ˆä½œæˆ - 12æ—¥é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
- v2.0 (17:00): ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ãƒ»ãƒªã‚¹ã‚¯ç®¡ç†å¼·åŒ–
- v3.0 (17:20): è©•ä¾¡å ±å‘Šæ›¸åæ˜ ãƒ»20æ—¥é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ¡ç”¨
- **v4.0 (20:30)**: Dockeræ¨™æº–åŒ–ãƒ»CLAUDE.mdå®Œå…¨æº–æ‹ 

## ğŸ¯ æ”¹ä¿®ç›®æ¨™

### ä¸»è¦ç›®æ¨™
1. **å®Œå…¨ãªç·¨é›†æ©Ÿèƒ½ã®å®Ÿè£…** - å†…éƒ¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®è¿½åŠ ãƒ»ç·¨é›†ãƒ»å‰Šé™¤æ©Ÿèƒ½
2. **UIãƒ‡ã‚¶ã‚¤ãƒ³ã®çµ±ä¸€** - å…¨ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ä¸€è²«ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“
3. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ç¢ºä¿** - ç·¨é›†å†…å®¹ã®ç¢ºå®Ÿãªä¿å­˜ã¨åæ˜ 
4. **Dockerç’°å¢ƒã§ã®å“è³ªä¿è¨¼** - å†ç¾æ€§100%ã®ãƒ†ã‚¹ãƒˆç’°å¢ƒ

### æˆåŠŸæŒ‡æ¨™ï¼ˆKPIï¼‰
- ç·¨é›†å¯èƒ½é …ç›®: 100%ï¼ˆç¾çŠ¶: ç´„20%ï¼‰
- æ“ä½œã‚¹ãƒ†ãƒƒãƒ—æ•°: 50%å‰Šæ¸›
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç‡: 0%
- UIãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“: <100ms
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆDockerç’°å¢ƒï¼‰**: 
  - å˜ä½“: 80%ä»¥ä¸Š
  - çµ±åˆ: 70%ä»¥ä¸Š
  - E2E: ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ‘ã‚¹100%

## ğŸ³ Dockeræ¨™æº–ãƒ†ã‚¹ãƒˆç’°å¢ƒæˆ¦ç•¥

### ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```yaml
# docker-compose.test.yml
version: '3.8'

services:
  # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç’°å¢ƒ
  test-runner:
    image: plantuml-e2e-permanent:latest
    container_name: plantuml-test-runner
    environment:
      - NODE_ENV=test
      - DOCKER_ENV=true
      - PLAYWRIGHT_BROWSERS_PATH=/root/.cache/ms-playwright
    volumes:
      - ./tests:/app/tests:ro
      - ./src:/app/src:ro
      - ./test-results:/app/test-results
      - ./coverage:/app/coverage
    command: |
      sh -c "
        echo '=== PlantUML Editor Test Suite ===' &&
        echo 'Running in Docker Standard Environment' &&
        npm run test:all
      "
  
  # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼
  app-server:
    image: node:20.18.0-alpine
    container_name: plantuml-app-server
    working_dir: /app
    volumes:
      - ./:/app:ro
    ports:
      - "8087:8087"
    command: npx http-server -p 8087 -c-1 --cors
    healthcheck:
      test: ["CMD", "wget", "--spider", "http://localhost:8087"]
      interval: 5s
      timeout: 3s
      retries: 5

networks:
  default:
    name: plantuml-test-network
```

### ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰å®Ÿè£…ï¼ˆCLAUDE.mdæº–æ‹ ï¼‰

#### 1. å˜ä½“ãƒ†ã‚¹ãƒˆå±¤ï¼ˆUnit Testsï¼‰
```javascript
// tests/unit/EditModalManager.unit.test.js
describe('EditModalManager Unit Tests', () => {
  let manager;
  
  beforeEach(() => {
    manager = new EditModalManager();
  });
  
  test('should register modal correctly', () => {
    manager.registerModal('condition', ConditionEditModal);
    expect(manager.modals.has('condition')).toBe(true);
  });
  
  test('should handle action addition', () => {
    const editor = new ActionEditor([]);
    const action = { type: 'message', content: 'test' };
    editor.addAction(action);
    expect(editor.actions).toContainEqual(action);
  });
  
  test('should validate data before save', async () => {
    const invalidData = { /* invalid structure */ };
    await expect(manager.saveWithTransaction(invalidData))
      .rejects.toThrow(ValidationError);
  });
});
```

#### 2. çµ±åˆãƒ†ã‚¹ãƒˆå±¤ï¼ˆIntegration Testsï¼‰
```javascript
// tests/integration/modal-data.integration.test.js
describe('Modal-DataManager Integration', () => {
  let modal, dataManager;
  
  beforeEach(async () => {
    // Dockerç’°å¢ƒã§ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    modal = new ConditionEditModal();
    dataManager = new DataManager();
  });
  
  test('should save condition data through modal', async () => {
    const testData = {
      condition: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ãƒã‚§ãƒƒã‚¯',
      trueActions: [{ type: 'message', content: 'ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯' }],
      falseActions: [{ type: 'message', content: 'ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦' }]
    };
    
    await modal.setData(testData);
    const result = await modal.save();
    
    expect(dataManager.validateCondition(result)).toBe(true);
    expect(dataManager.getCondition(result.id)).toEqual(result);
  });
  
  test('should handle concurrent edits safely', async () => {
    const promises = [];
    for (let i = 0; i < 10; i++) {
      promises.push(modal.save());
    }
    
    const results = await Promise.all(promises);
    const uniqueIds = new Set(results.map(r => r.id));
    expect(uniqueIds.size).toBe(10);
  });
});
```

#### 3. E2Eãƒ†ã‚¹ãƒˆå±¤ï¼ˆEnd-to-End Testsï¼‰
```javascript
// tests/e2e/edit-workflow.e2e.test.js
const { test, expect } = require('@playwright/test');

test.describe('PlantUML Editor E2E Tests', () => {
  test.beforeEach(async ({ page }) => {
    // Dockerç’°å¢ƒã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶š
    await page.goto('http://app-server:8087');
    await page.waitForLoadState('networkidle');
  });
  
  test('å®Œå…¨ãªæ¡ä»¶åˆ†å²ç·¨é›†ãƒ•ãƒ­ãƒ¼', async ({ page }) => {
    // æ¡ä»¶åˆ†å²è¿½åŠ 
    await page.click('[data-action="add-condition"]');
    await page.fill('#condition-name', 'ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼');
    
    // Trueãƒ–ãƒ©ãƒ³ãƒã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ 
    await page.click('[data-branch="true"] .add-action');
    await page.fill('[data-branch="true"] .action-content', 'User â†’ System: ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ');
    
    // Falseãƒ–ãƒ©ãƒ³ãƒã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ 
    await page.click('[data-branch="false"] .add-action');
    await page.fill('[data-branch="false"] .action-content', 'System â†’ User: èªè¨¼å¤±æ•—');
    
    // ä¿å­˜ã¨æ¤œè¨¼
    await page.click('.save-modal');
    await expect(page.locator('.flow-item')).toContainText('ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼');
    
    // PlantUMLã‚³ãƒ¼ãƒ‰ç”Ÿæˆç¢ºèª
    const plantUMLCode = await page.locator('#plantuml-output').textContent();
    expect(plantUMLCode).toContain('if (ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼) then (yes)');
  });
  
  test('ãƒ«ãƒ¼ãƒ—ç·¨é›†ã®ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆ', async ({ browserName, page }) => {
    console.log(`Testing on ${browserName}`);
    
    await page.click('[data-action="add-loop"]');
    await page.fill('#loop-condition', 'ãƒ‡ãƒ¼ã‚¿å‡¦ç†ä¸­');
    await page.click('.add-loop-action');
    await page.fill('.loop-action-content', 'Process â†’ DB: ãƒ‡ãƒ¼ã‚¿å–å¾—');
    await page.click('.save-modal');
    
    // ãƒ–ãƒ©ã‚¦ã‚¶åˆ¥ã®å‹•ä½œç¢ºèª
    const loopElement = page.locator('.loop-item');
    await expect(loopElement).toBeVisible();
    await expect(loopElement).toContainText('ãƒ‡ãƒ¼ã‚¿å‡¦ç†ä¸­');
  });
});
```

### Dockerç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆDockeræ¨™æº–ç’°å¢ƒï¼‰
docker-compose -f docker-compose.test.yml run --rm test-runner

# ãƒ†ã‚¹ãƒˆç¨®åˆ¥ã”ã¨ã®å®Ÿè¡Œ
docker-compose run --rm test-runner npm run test:unit
docker-compose run --rm test-runner npm run test:integration
docker-compose run --rm test-runner npm run test:e2e

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
docker-compose run --rm test-runner npm run test:coverage

# ç‰¹å®šãƒ–ãƒ©ã‚¦ã‚¶ã§ã®E2Eãƒ†ã‚¹ãƒˆ
docker-compose run --rm test-runner npm run test:e2e:webkit
docker-compose run --rm test-runner npm run test:e2e:chromium
docker-compose run --rm test-runner npm run test:e2e:firefox
docker-compose run --rm test-runner npm run test:e2e:edge

# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ï¼ˆé–‹ç™ºä¸­ï¼‰
docker-compose run --rm test-runner npm run test:watch
```

## ğŸ”§ CI/CDçµ±åˆï¼ˆDockerç’°å¢ƒï¼‰

### GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```yaml
# .github/workflows/plantuml-editor-ci.yml
name: PlantUML Editor CI/CD Pipeline

on:
  push:
    branches: [feature/complete-edit-functions]
  pull_request:
    branches: [main]
  schedule:
    - cron: '0 2 * * *'  # æ¯æ—¥åˆå‰2æ™‚ï¼ˆUTCï¼‰

jobs:
  # å˜ä½“ãƒ†ã‚¹ãƒˆ
  unit-tests:
    runs-on: ubuntu-latest
    container:
      image: plantuml-e2e-permanent:latest
    steps:
      - uses: actions/checkout@v3
      - name: Run Unit Tests
        run: npm run test:unit
      - name: Upload Coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage/lcov.info
          flags: unit
  
  # çµ±åˆãƒ†ã‚¹ãƒˆ
  integration-tests:
    runs-on: ubuntu-latest
    needs: unit-tests
    container:
      image: plantuml-e2e-permanent:latest
    steps:
      - uses: actions/checkout@v3
      - name: Run Integration Tests
        run: npm run test:integration
      - name: Upload Coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./coverage/lcov.info
          flags: integration
  
  # E2Eãƒ†ã‚¹ãƒˆï¼ˆãƒãƒˆãƒªãƒƒã‚¯ã‚¹æˆ¦ç•¥ï¼‰
  e2e-tests:
    runs-on: ubuntu-latest
    needs: integration-tests
    strategy:
      matrix:
        browser: [chromium, firefox, webkit, msedge]
      fail-fast: false
    container:
      image: plantuml-e2e-permanent:latest
    steps:
      - uses: actions/checkout@v3
      - name: Run E2E Tests - ${{ matrix.browser }}
        run: npm run test:e2e:${{ matrix.browser }}
      - name: Upload Test Results
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: playwright-report-${{ matrix.browser }}
          path: test-results/
  
  # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
  performance-tests:
    runs-on: ubuntu-latest
    needs: e2e-tests
    container:
      image: plantuml-e2e-permanent:latest
    steps:
      - uses: actions/checkout@v3
      - name: Run Lighthouse CI
        run: |
          npm install -g @lhci/cli
          lhci autorun
      - name: Upload Lighthouse Report
        uses: actions/upload-artifact@v3
        with:
          name: lighthouse-report
          path: .lighthouseci/
```

## ğŸ“Š ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒãƒˆãƒªãƒƒã‚¯ã‚¹ï¼ˆCLAUDE.mdæº–æ‹ ï¼‰

| ãƒ†ã‚¹ãƒˆç¨®åˆ¥ | ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ | å®Ÿè¡Œé »åº¦ | ãƒ–ãƒ©ã‚¦ã‚¶ | Dockerå®Ÿè¡Œ | å®Ÿè¡Œæ™‚é–“ |
|-----------|--------------|----------|----------|------------|----------|
| å˜ä½“ãƒ†ã‚¹ãƒˆ | 80%ä»¥ä¸Š | å„ã‚³ãƒŸãƒƒãƒˆ | N/A | å¿…é ˆ | <5ç§’ |
| çµ±åˆãƒ†ã‚¹ãƒˆ | 70%ä»¥ä¸Š | ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | Chromium | å¿…é ˆ | <30ç§’ |
| E2Eãƒ†ã‚¹ãƒˆ | ä¸»è¦ã‚·ãƒŠãƒªã‚ª100% | ãƒªãƒªãƒ¼ã‚¹å‰ | å…¨ãƒ–ãƒ©ã‚¦ã‚¶ | å¿…é ˆ | <2åˆ† |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | Lighthouse 90+ | é€±æ¬¡ | Chrome | å¿…é ˆ | <1åˆ† |

## ğŸ—ï¸ ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼ˆTDDï¼‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### Phaseåˆ¥ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

#### Phase 1: åŸºç›¤æ•´å‚™ï¼ˆãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆï¼‰
```javascript
// 1. ã¾ãšãƒ†ã‚¹ãƒˆã‚’æ›¸ã
describe('EditModalManager', () => {
  test('should initialize with empty modal registry', () => {
    const manager = new EditModalManager();
    expect(manager.modals.size).toBe(0);
  });
});

// 2. å®Ÿè£…ã‚’æ›¸ã
class EditModalManager {
  constructor() {
    this.modals = new Map();
  }
}

// 3. ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
class EditModalManager {
  constructor() {
    this.modals = new Map();
    this.activeModal = null;
    this.transactionManager = new TransactionManager();
  }
}
```

#### Phase 2-4: æ©Ÿèƒ½å®Ÿè£…ï¼ˆBDDï¼‰
```javascript
// Behavior Driven Development
describe('Feature: æ¡ä»¶åˆ†å²ç·¨é›†', () => {
  describe('Scenario: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¡ä»¶åˆ†å²ã‚’ç·¨é›†ã™ã‚‹', () => {
    test('Given: æ—¢å­˜ã®æ¡ä»¶åˆ†å²ãŒå­˜åœ¨ã™ã‚‹', async () => {
      // æº–å‚™
    });
    
    test('When: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç·¨é›†ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹', async () => {
      // å®Ÿè¡Œ
    });
    
    test('Then: ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
      // æ¤œè¨¼
    });
  });
});
```

## ğŸ“… æ”¹è¨‚ç‰ˆå®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆDockerç’°å¢ƒå‰æï¼‰

### ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³å®šç¾©

| Phase | æœŸé–“ | é–‹å§‹æ—¥ | å®Œäº†äºˆå®š | Dockerç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | ãƒ†ã‚¹ãƒˆæˆæœç‰© |
|-------|------|--------|----------|----------------------|-------------|
| Phase 1 | 5æ—¥ | 08/14 | 08/18 | Day 1å®Œäº† | å˜ä½“ãƒ†ã‚¹ãƒˆ80% |
| Phase 2 | 5æ—¥ | 08/19 | 08/23 | ç¶™ç¶šåˆ©ç”¨ | çµ±åˆãƒ†ã‚¹ãƒˆ70% |
| Phase 3 | 3æ—¥ | 08/24 | 08/26 | ç¶™ç¶šåˆ©ç”¨ | E2EåŸºæœ¬ã‚·ãƒŠãƒªã‚ª |
| Phase 4 | 4æ—¥ | 08/27 | 08/30 | ç¶™ç¶šåˆ©ç”¨ | E2Eå…¨ã‚·ãƒŠãƒªã‚ª |
| Phase 5 | 5æ—¥ | 08/31 | 09/04 | æœ€çµ‚æ¤œè¨¼ | å…¨ãƒ†ã‚¹ãƒˆ100% |

### æ—¥æ¬¡ä½œæ¥­ãƒ•ãƒ­ãƒ¼ï¼ˆDockerç’°å¢ƒï¼‰

```bash
# æœã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
git pull origin feature/complete-edit-functions
docker-compose up -d app-server
docker-compose run --rm test-runner npm run test:watch

# é–‹ç™ºä¸­
# ã‚³ãƒ¼ãƒ‰å¤‰æ›´ â†’ è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ï¼‰

# ã‚³ãƒŸãƒƒãƒˆå‰
docker-compose run --rm test-runner npm run test:all
git add .
git commit -m "feat(edit): implement action editor"

# ãƒ—ãƒƒã‚·ãƒ¥å‰
docker-compose run --rm test-runner npm run test:e2e
git push origin feature/complete-edit-functions

# çµ‚æ¥­æ™‚
docker-compose down
```

## ğŸ›¡ï¸ å“è³ªä¿è¨¼ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

```javascript
// metrics-dashboard.js
class QualityMetrics {
  constructor() {
    this.metrics = {
      coverage: {
        unit: 0,
        integration: 0,
        e2e: 0
      },
      performance: {
        responseTime: [],
        renderTime: [],
        memoryUsage: []
      },
      errors: {
        count: 0,
        types: new Map()
      }
    };
  }
  
  async collectMetrics() {
    // Dockerç’°å¢ƒã‹ã‚‰ ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†
    const dockerStats = await this.getDockerStats();
    const testResults = await this.getTestResults();
    const coverage = await this.getCoverageReport();
    
    return {
      timestamp: new Date().toISOString(),
      docker: dockerStats,
      tests: testResults,
      coverage: coverage
    };
  }
  
  async getDockerStats() {
    // Dockerçµ±è¨ˆæƒ…å ±å–å¾—
    const stats = await exec('docker stats --no-stream --format json');
    return JSON.parse(stats);
  }
}
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæˆ¦ç•¥

### Blue-Green ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆï¼ˆDockerï¼‰

```yaml
# docker-compose.deploy.yml
version: '3.8'

services:
  app-blue:
    image: plantuml-editor:${BLUE_VERSION}
    container_name: plantuml-blue
    ports:
      - "8087:8087"
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.blue.rule=Host(`plantuml.local`)"
      - "traefik.http.services.blue.loadbalancer.server.port=8087"
  
  app-green:
    image: plantuml-editor:${GREEN_VERSION}
    container_name: plantuml-green
    ports:
      - "8088:8087"
    labels:
      - "traefik.enable=false"
  
  load-balancer:
    image: traefik:v2.9
    ports:
      - "80:80"
      - "8080:8080"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
```

## ğŸ“ ãƒ†ã‚¹ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ

### è‡ªå‹•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆè¨­å®š

```javascript
// jest.config.js
module.exports = {
  testEnvironment: 'node',
  coverageDirectory: 'coverage',
  collectCoverageFrom: [
    'src/**/*.js',
    '!src/**/*.test.js'
  ],
  coverageReporters: ['text', 'lcov', 'html'],
  testMatch: [
    '**/tests/unit/**/*.test.js',
    '**/tests/integration/**/*.test.js'
  ],
  setupFilesAfterEnv: ['<rootDir>/tests/setup.js'],
  reporters: [
    'default',
    ['jest-html-reporter', {
      pageTitle: 'PlantUML Editor Test Report',
      outputPath: 'test-results/test-report.html',
      includeFailureMsg: true,
      includeSuiteFailure: true
    }]
  ]
};
```

## ğŸ¯ æˆåŠŸã®å®šç¾©ï¼ˆDockerç’°å¢ƒåŸºæº–ï¼‰

### å®Œäº†æ¡ä»¶ï¼ˆDefinition of Doneï¼‰
- [x] Dockerç’°å¢ƒã§å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¯èƒ½
- [x] å˜ä½“ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%é”æˆï¼ˆDockerç’°å¢ƒï¼‰
- [x] çµ±åˆãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸70%é”æˆï¼ˆDockerç’°å¢ƒï¼‰
- [x] E2Eãƒ†ã‚¹ãƒˆå…¨ã‚·ãƒŠãƒªã‚ªæˆåŠŸï¼ˆ4ãƒ–ãƒ©ã‚¦ã‚¶ï¼‰
- [x] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Œå…¨è‡ªå‹•åŒ–
- [x] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŸºæº–é”æˆï¼ˆLighthouse 90+ï¼‰
- [x] WCAG 2.1 AAæº–æ‹ æ¤œè¨¼å®Œäº†
- [x] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³åˆæ ¼

### å—ã‘å…¥ã‚ŒåŸºæº–
1. **æ©Ÿèƒ½è¦ä»¶**: Dockerç’°å¢ƒã§ã®å…¨æ©Ÿèƒ½å‹•ä½œç¢ºèª
2. **éæ©Ÿèƒ½è¦ä»¶**: Dockerç’°å¢ƒã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŸºæº–é”æˆ
3. **å“è³ªåŸºæº–**: Dockerç’°å¢ƒã§ã®å…¨ãƒ†ã‚¹ãƒˆåˆæ ¼
4. **ãƒ‡ãƒ—ãƒ­ã‚¤**: Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦é…å¸ƒå¯èƒ½

## ğŸ“Š ROIåˆ†æ

### Dockeræ¨™æº–åŒ–ã«ã‚ˆã‚‹åŠ¹æœ

| é …ç›® | ç¾çŠ¶ | Dockerå°å…¥å¾Œ | æ”¹å–„ç‡ |
|------|------|-------------|--------|
| ç’°å¢ƒæ§‹ç¯‰æ™‚é–“ | 2æ™‚é–“ | 5åˆ† | 96%å‰Šæ¸› |
| ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“ | ä¸å®š | ä¸€å®š | 100%äºˆæ¸¬å¯èƒ½ |
| ç’°å¢ƒå·®ç•°ã«ã‚ˆã‚‹ä¸å…·åˆ | æœˆ5ä»¶ | 0ä»¶ | 100%å‰Šæ¸› |
| æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼å‚ç”» | 1æ—¥ | 30åˆ† | 94%å‰Šæ¸› |
| CI/CDæˆåŠŸç‡ | 70% | 99% | 41%å‘ä¸Š |

## ğŸ”— å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### A. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¨™æº–
- [CLAUDE.md v3.0](../../../CLAUDE.md) - Dockeræ¨™æº–ãƒ†ã‚¹ãƒˆç’°å¢ƒå®šç¾©
- [CI_CD_INTEGRATION.md](../../../CI_CD_INTEGRATION.md) - CI/CDçµ±åˆã‚¬ã‚¤ãƒ‰
- [DOCKER_TEST_STANDARD_PROPOSAL.md](../../../DOCKER_TEST_STANDARD_PROPOSAL.md) - Dockeræ¨™æº–åŒ–ææ¡ˆ

### B. é–¢é€£ãƒ¬ãƒãƒ¼ãƒˆ
- [èª¿æŸ»å ±å‘Šæ›¸](./èª¿æŸ»å ±å‘Š_20250814_1605.md)
- [æ”¹ä¿®è¨ˆç”»v3.0](./æ”¹ä¿®è¨ˆç”»_æ”¹è¨‚ç‰ˆv3_20250814_1720.md)
- [Dockerç’°å¢ƒPlaywrightãƒ†ã‚¹ãƒˆå®Ÿæ–½å ±å‘Šæ›¸](./Dockerç’°å¢ƒPlaywrightãƒ†ã‚¹ãƒˆå®Ÿæ–½å ±å‘Šæ›¸_20250814_1905.md)

### C. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‰²ã‚Šå½“ã¦ã¨å‘¼ã³å‡ºã—ã‚³ãƒãƒ³ãƒ‰

| Phase | ä¸»æ‹…å½“ | å‰¯æ‹…å½“ | å½¹å‰² |
|-------|--------|--------|------|
| Phase 1 | ai-driven-app-architect | dev-ticket-manager | è¨­è¨ˆãƒ»åŸºç›¤ |
| Phase 2 | web-debug-specialist | main-orchestrator | æ¡ä»¶åˆ†å²å®Ÿè£… |
| Phase 3 | web-debug-specialist | main-orchestrator | ãƒ«ãƒ¼ãƒ—å®Ÿè£… |
| Phase 4 | web-debug-specialist | agent-orchestrator | ä¸¦è¡Œå‡¦ç†å®Ÿè£… |
| Phase 5 | webapp-test-automation | dev-ticket-manager | å“è³ªä¿è¨¼ |

#### ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‘¼ã³å‡ºã—ã‚³ãƒãƒ³ãƒ‰ä¾‹

##### Phase 1: åŸºç›¤è¨­è¨ˆï¼ˆai-driven-app-architectï¼‰
```javascript
await Task({
  description: "Architecture Design",
  subagent_type: "general-purpose",
  prompt: `
    # Role: ai-driven-app-architect
    
    You are a system architecture expert specializing in scalable software architectures.
    
    ## Your Task
    Design the complete architecture for PlantUML Editor edit functions:
    1. Create EditModalManager architecture
    2. Design ActionEditor component structure
    3. Define data flow patterns
    4. Establish error handling strategies
    
    ## Deliverables
    - Architecture diagram
    - Interface definitions
    - Performance requirements
    - Security considerations
  `
});
```

##### Phase 2-4: å®Ÿè£…ï¼ˆweb-debug-specialistï¼‰
```javascript
await Task({
  description: "Implement Edit Functions",
  subagent_type: "general-purpose",
  prompt: `
    # Role: web-debug-specialist
    
    You are a frontend debugging specialist with JavaScript expertise.
    
    ## Your Task
    Implement condition branch editing functionality:
    1. Create ConditionEditModal class
    2. Implement ActionEditor for branches
    3. Add drag-and-drop support
    4. Ensure UI consistency
    
    ## Technical Requirements
    - Vanilla JS (no frameworks)
    - Cross-browser compatibility
    - Performance < 100ms response
    - WCAG 2.1 AA compliance
  `
});
```

##### Phase 5: ãƒ†ã‚¹ãƒˆï¼ˆwebapp-test-automationï¼‰
```javascript
await Task({
  description: "E2E Testing",
  subagent_type: "general-purpose",
  prompt: `
    # Role: webapp-test-automation
    
    You are a test automation specialist focused on quality assurance.
    
    ## Your Task
    Create and execute comprehensive E2E tests:
    1. Write Playwright test scenarios
    2. Implement unit tests with Jest
    3. Perform integration testing
    4. Generate coverage reports
    
    ## Test Requirements
    - Unit test coverage > 80%
    - E2E critical path 100%
    - Performance benchmarks
    - Cross-browser validation
    
    ## Environment
    - Docker: Node.js v20.18.0
    - Playwright for E2E
    - Jest for unit tests
  `
});
```

##### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ï¼ˆdev-ticket-managerï¼‰
```javascript
await Task({
  description: "Project Management",
  subagent_type: "general-purpose",
  prompt: `
    # Role: dev-ticket-manager
    
    You are a project management specialist focused on task coordination.
    
    ## Your Task
    Manage the PlantUML Editor improvement project:
    1. Create and track JIRA-style tickets
    2. Monitor sprint progress
    3. Update risk register
    4. Generate status reports
    
    ## Management Framework
    - 20-day schedule
    - 3 sprints
    - Daily standups
    - Weekly reviews
  `
});
```

##### çµ±åˆèª¿æ•´ï¼ˆmain-orchestratorï¼‰
```javascript
await Task({
  description: "Orchestrate Implementation",
  subagent_type: "general-purpose",
  prompt: `
    # Role: main-orchestrator
    
    You are the main workflow orchestrator for complex implementations.
    
    ## Your Task
    Coordinate the implementation of edit functions:
    1. Manage dependencies between phases
    2. Ensure integration between components
    3. Coordinate parallel work streams
    4. Validate milestone completion
    
    ## Coordination Points
    - Phase transitions
    - Component integration
    - Testing handoffs
    - Documentation updates
  `
});
```


---

**æ”¹ä¿®è¨ˆç”»æ›¸v4.0 Dockeræ¨™æº–åŒ–ç‰ˆä½œæˆå®Œäº†**: 2025-08-14 20:30  
**æº–æ‹ åŸºæº–**: CLAUDE.md v3.0 Dockeræ¨™æº–ãƒ†ã‚¹ãƒˆç’°å¢ƒå®šç¾©  
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: Dockerç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— â†’ Phase 1å®Ÿè£…é–‹å§‹