<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 4 - åŒ…æ‹¬çš„E2Eãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .test-header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .test-header h1 {
            margin: 0;
            font-size: 32px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .test-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #6c757d;
            margin-top: 5px;
        }
        
        .test-sections {
            padding: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #3498db;
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .test-case {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .test-case:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .test-case h3 {
            margin-top: 0;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .test-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .status-pending {
            background: #ffc107;
            color: #856404;
        }
        
        .status-running {
            background: #17a2b8;
            color: white;
            animation: pulse 1.5s infinite;
        }
        
        .status-passed {
            background: #28a745;
            color: white;
        }
        
        .status-failed {
            background: #dc3545;
            color: white;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .test-output {
            background: #2c3e50;
            color: #1abc9c;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            padding: 20px;
            background: #e9ecef;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .performance-chart {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .memory-bar {
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .memory-usage {
            height: 100%;
            background: linear-gradient(90deg, #43e97b 0%, #ffc107 50%, #f5576c 100%);
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .error-log {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
        }
        
        .success-log {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
        }
        
        .icon {
            font-size: 24px;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            stroke-dasharray: 339.292;
            stroke-dashoffset: 339.292;
            animation: progress 2s ease-out forwards;
        }
        
        @keyframes progress {
            to {
                stroke-dashoffset: 0;
            }
        }

        .test-iframe {
            width: 100%;
            height: 600px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            margin-top: 20px;
        }

        .scenario-description {
            background: #e8f4fd;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .metric-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }

        .metric-label {
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ğŸš€ Phase 4 - åŒ…æ‹¬çš„E2Eãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ</h1>
            <p>PlantUMLã‚¨ãƒ‡ã‚£ã‚¿ã®å®Œå…¨ãªçµ±åˆãƒ†ã‚¹ãƒˆ</p>
        </div>

        <div class="test-stats">
            <div class="stat-card">
                <div class="stat-value" id="total-tests">0</div>
                <div class="stat-label">ç·ãƒ†ã‚¹ãƒˆæ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="passed-tests">0</div>
                <div class="stat-label">æˆåŠŸ</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="failed-tests">0</div>
                <div class="stat-label">å¤±æ•—</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="coverage">0%</div>
                <div class="stat-label">ã‚«ãƒãƒ¬ãƒƒã‚¸</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="exec-time">0ms</div>
                <div class="stat-label">å®Ÿè¡Œæ™‚é–“</div>
            </div>
        </div>

        <div class="test-controls">
            <button class="btn btn-primary" onclick="runAllTests()">
                â–¶ï¸ å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            </button>
            <button class="btn btn-success" onclick="runIntegrationTests()">
                ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆ
            </button>
            <button class="btn btn-danger" onclick="runStressTests()">
                ğŸ’ª ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ
            </button>
            <button class="btn btn-primary" onclick="generateReport()">
                ğŸ“Š ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
            </button>
        </div>

        <!-- ãƒ†ã‚¹ãƒˆç”¨iframeï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ -->
        <div style="padding: 20px;">
            <h3>ğŸ“± ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤ºã‚¨ãƒªã‚¢</h3>
            <iframe id="app-frame" class="test-iframe" src="http://localhost:8083/index.html"></iframe>
        </div>

        <div class="test-sections">
            <!-- 1. çµ±åˆãƒ†ã‚¹ãƒˆ -->
            <div class="test-section">
                <h2><span class="icon">ğŸ”—</span> çµ±åˆãƒ†ã‚¹ãƒˆ (Integration Tests)</h2>
                <div class="scenario-description">
                    <strong>ã‚·ãƒŠãƒªã‚ª:</strong> å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’å®Œå…¨ã«å†ç¾ã—ã€ã‚¢ã‚¯ã‚¿ãƒ¼é¸æŠã‹ã‚‰å›³ã®ç”Ÿæˆã¾ã§ã®å…¨ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ¤œè¨¼
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-basic-flow">
                        <h3>ğŸ“ åŸºæœ¬ãƒ•ãƒ­ãƒ¼</h3>
                        <p>ã‚¢ã‚¯ã‚¿ãƒ¼é¸æŠâ†’å‡¦ç†è¿½åŠ â†’ã‚³ãƒ¼ãƒ‰ç”Ÿæˆâ†’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-complex-structures">
                        <h3>ğŸ—ï¸ è¤‡é›‘æ§‹é€ </h3>
                        <p>ãƒ«ãƒ¼ãƒ—ã€æ¡ä»¶åˆ†å²ã€ä¸¦è¡Œå‡¦ç†ã‚’å«ã‚€å›³ã®ç”Ÿæˆ</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-bidirectional-sync">
                        <h3>ğŸ”„ åŒæ–¹å‘åŒæœŸ</h3>
                        <p>ã‚³ãƒ¼ãƒ‰ç·¨é›†â†’GUIæ›´æ–°ã€GUIæ“ä½œâ†’ã‚³ãƒ¼ãƒ‰æ›´æ–°</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ -->
            <div class="test-section">
                <h2><span class="icon">âš ï¸</span> ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ</h2>
                <div class="scenario-description">
                    <strong>ã‚·ãƒŠãƒªã‚ª:</strong> æ§˜ã€…ãªã‚¨ãƒ©ãƒ¼çŠ¶æ³ã‚’æ„å›³çš„ã«ç™ºç”Ÿã•ã›ã€é©åˆ‡ãªã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨å¾©æ—§æ©Ÿèƒ½ã‚’æ¤œè¨¼
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-syntax-error">
                        <h3>âŒ æ§‹æ–‡ã‚¨ãƒ©ãƒ¼</h3>
                        <p>ä¸æ­£ãªPlantUMLæ§‹æ–‡ã®å…¥åŠ›ã¨æ¤œå‡º</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-auto-recovery">
                        <h3>ğŸ”§ è‡ªå‹•å¾©æ—§</h3>
                        <p>ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿå¾Œã®è‡ªå‹•å¾©æ—§æ©Ÿèƒ½</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-error-dialog">
                        <h3>ğŸ’¬ ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°</h3>
                        <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ã‚¨ãƒ©ãƒ¼é€šçŸ¥æ©Ÿèƒ½</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ -->
            <div class="test-section">
                <h2><span class="icon">âš¡</span> ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</h2>
                <div class="scenario-description">
                    <strong>ã‚·ãƒŠãƒªã‚ª:</strong> å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã‚’æ¸¬å®šã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æ©Ÿèƒ½ã‚’æ¤œè¨¼
                </div>
                
                <div class="performance-chart">
                    <h4>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</h4>
                    <div class="memory-bar">
                        <div class="memory-usage" id="memory-usage">0%</div>
                    </div>
                </div>
                
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="render-time">0ms</div>
                        <div class="metric-label">ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚é–“</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="memory-mb">0MB</div>
                        <div class="metric-label">ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="cpu-usage">0%</div>
                        <div class="metric-label">CPUä½¿ç”¨ç‡</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="cache-hit">0%</div>
                        <div class="metric-label">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡</div>
                    </div>
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-large-diagram">
                        <h3>ğŸ“Š å¤§è¦æ¨¡å›³å‡¦ç†</h3>
                        <p>1000è¡Œã®PlantUMLã‚³ãƒ¼ãƒ‰å‡¦ç†</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-rapid-updates">
                        <h3>âš¡ é«˜é€Ÿæ›´æ–°</h3>
                        <p>é€£ç¶šçš„ãªæ›´æ–°ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 4. å…¥åŠ›æ¤œè¨¼ãƒ†ã‚¹ãƒˆ -->
            <div class="test-section">
                <h2><span class="icon">âœ…</span> å…¥åŠ›æ¤œè¨¼ãƒ†ã‚¹ãƒˆ</h2>
                <div class="scenario-description">
                    <strong>ã‚·ãƒŠãƒªã‚ª:</strong> æ§˜ã€…ãªå…¥åŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾ã™ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã¨è‡ªå‹•ä¿®æ­£æ©Ÿèƒ½ã‚’æ¤œè¨¼
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-japanese-validation">
                        <h3>ğŸ‡¯ğŸ‡µ æ—¥æœ¬èªæ¤œè¨¼</h3>
                        <p>æ—¥æœ¬èªæ–‡æ³•ã®æ¤œè¨¼ã¨ä¿®æ­£</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-security-check">
                        <h3>ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h3>
                        <p>æ‚ªæ„ã®ã‚ã‚‹å…¥åŠ›ã®æ¤œå‡º</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-auto-fix">
                        <h3>ğŸ”§ è‡ªå‹•ä¿®æ­£</h3>
                        <p>ä¸€èˆ¬çš„ãªã‚¨ãƒ©ãƒ¼ã®è‡ªå‹•ä¿®æ­£</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 5. ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ -->
            <div class="test-section">
                <h2><span class="icon">ğŸ’ª</span> ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ</h2>
                <div class="scenario-description">
                    <strong>ã‚·ãƒŠãƒªã‚ª:</strong> æ¥µé™çŠ¶æ³ä¸‹ã§ã®ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§ã¨ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã®æ¤œè¨¼
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-memory-leak">
                        <h3>ğŸ’¾ ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯</h3>
                        <p>é•·æ™‚é–“å‹•ä½œã§ã®ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯æ¤œè¨¼</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-concurrent-ops">
                        <h3>ğŸ”€ ä¸¦è¡Œæ“ä½œ</h3>
                        <p>è¤‡æ•°ã®åŒæ™‚æ“ä½œã®å‡¦ç†</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-extreme-load">
                        <h3>ğŸŒ‹ æ¥µé™è² è·</h3>
                        <p>ã‚·ã‚¹ãƒ†ãƒ é™ç•Œã¾ã§ã®è² è·ãƒ†ã‚¹ãƒˆ</p>
                        <div class="test-status status-pending">å¾…æ©Ÿä¸­</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            coverage: 0,
            executionTime: 0,
            details: []
        };

        let appFrame = null;
        let appWindow = null;
        let appDocument = null;

        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ã®åˆæœŸåŒ–
        window.onload = function() {
            appFrame = document.getElementById('app-frame');
            appFrame.onload = function() {
                appWindow = appFrame.contentWindow;
                appDocument = appFrame.contentDocument;
                console.log('âœ… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ åˆæœŸåŒ–å®Œäº†');
            };
        };

        // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé–¢æ•°
        async function runAllTests() {
            console.log('ğŸš€ å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé–‹å§‹');
            const startTime = Date.now();
            
            // çµ±è¨ˆãƒªã‚»ãƒƒãƒˆ
            testResults = {
                total: 0,
                passed: 0,
                failed: 0,
                coverage: 0,
                executionTime: 0,
                details: []
            };

            // å„ãƒ†ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒªã‚’é †æ¬¡å®Ÿè¡Œ
            await runIntegrationTests();
            await sleep(1000);
            await runErrorHandlingTests();
            await sleep(1000);
            await runPerformanceTests();
            await sleep(1000);
            await runValidationTests();
            await sleep(1000);
            await runStressTests();
            
            // çµ±è¨ˆæ›´æ–°
            testResults.executionTime = Date.now() - startTime;
            testResults.coverage = Math.round((testResults.passed / testResults.total) * 100);
            updateStatistics();
            
            console.log('âœ… å…¨ãƒ†ã‚¹ãƒˆå®Œäº†');
            generateReport();
        }

        // 1. çµ±åˆãƒ†ã‚¹ãƒˆ
        async function runIntegrationTests() {
            console.log('ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            // åŸºæœ¬ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ
            await runTest('test-basic-flow', async () => {
                // ã‚¢ã‚¯ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
                const actorBtn = appDocument.querySelector('[data-actor="é¡§å®¢"]');
                if (!actorBtn) throw new Error('ã‚¢ã‚¯ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                actorBtn.click();
                await sleep(500);
                
                // ã‚‚ã†1ã¤ã‚¢ã‚¯ã‚¿ãƒ¼ã‚’è¿½åŠ 
                const actorBtn2 = appDocument.querySelector('[data-actor="ECã‚µã‚¤ãƒˆ"]');
                actorBtn2.click();
                await sleep(500);
                
                // å‡¦ç†ã‚’å…¥åŠ›
                const fromSelect = appDocument.getElementById('from-actor');
                const toSelect = appDocument.getElementById('to-actor');
                const actionInput = appDocument.getElementById('action-text');
                
                fromSelect.value = 'é¡§å®¢';
                toSelect.value = 'ECã‚µã‚¤ãƒˆ';
                actionInput.value = 'å•†å“ã‚’æ³¨æ–‡ã™ã‚‹';
                
                // è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
                const addBtn = appDocument.querySelector('.btn-add-action');
                addBtn.click();
                await sleep(500);
                
                // PlantUMLã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
                const codeArea = appDocument.getElementById('plantuml-code');
                const code = codeArea.value;
                
                if (!code.includes('é¡§å®¢') || !code.includes('ECã‚µã‚¤ãƒˆ')) {
                    throw new Error('PlantUMLã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                
                // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
                const preview = appDocument.getElementById('preview-svg');
                if (!preview.querySelector('svg') && !preview.querySelector('img')) {
                    console.warn('ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã¾ã ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼ˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°APIæœªæ¥ç¶šã®å¯èƒ½æ€§ï¼‰');
                }
                
                return 'åŸºæœ¬ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆæˆåŠŸ';
            });
            
            // è¤‡é›‘æ§‹é€ ãƒ†ã‚¹ãƒˆ
            await runTest('test-complex-structures', async () => {
                // ã‚³ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ã«ç›´æ¥è¤‡é›‘ãªæ§‹é€ ã‚’å…¥åŠ›
                const codeArea = appDocument.getElementById('plantuml-code');
                const complexCode = `@startuml
actor é¡§å®¢
participant ECã‚µã‚¤ãƒˆ
participant åœ¨åº«ç®¡ç†

é¡§å®¢ -> ECã‚µã‚¤ãƒˆ : æ³¨æ–‡
ECã‚µã‚¤ãƒˆ -> åœ¨åº«ç®¡ç† : åœ¨åº«ç¢ºèª

alt åœ¨åº«ã‚ã‚Š
    åœ¨åº«ç®¡ç† --> ECã‚µã‚¤ãƒˆ : OK
    ECã‚µã‚¤ãƒˆ -> é¡§å®¢ : æ³¨æ–‡ç¢ºå®š
else åœ¨åº«ãªã—
    åœ¨åº«ç®¡ç† --> ECã‚µã‚¤ãƒˆ : NG
    ECã‚µã‚¤ãƒˆ -> é¡§å®¢ : åœ¨åº«åˆ‡ã‚Œé€šçŸ¥
end

loop 3å›ã¾ã§
    é¡§å®¢ -> ECã‚µã‚¤ãƒˆ : å†è©¦è¡Œ
end

@enduml`;
                
                // ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
                codeArea.value = complexCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                await sleep(1000);
                
                // GUIã«åæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼ˆPhase 3ã®æ©Ÿèƒ½ï¼‰
                const actionItems = appDocument.querySelector('.action-items');
                if (actionItems && actionItems.children.length === 0) {
                    console.warn('GUIåŒæœŸæ©Ÿèƒ½ãŒã¾ã å‹•ä½œã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™');
                }
                
                return 'è¤‡é›‘æ§‹é€ ãƒ†ã‚¹ãƒˆå®Œäº†';
            });
            
            // åŒæ–¹å‘åŒæœŸãƒ†ã‚¹ãƒˆ
            await runTest('test-bidirectional-sync', async () => {
                // GUIæ“ä½œâ†’ã‚³ãƒ¼ãƒ‰æ›´æ–°
                const clearBtn = appDocument.querySelector('.btn-clear');
                clearBtn.click();
                await sleep(500);
                
                // ã‚¢ã‚¯ã‚¿ãƒ¼è¿½åŠ 
                const actorBtn = appDocument.querySelector('[data-actor="ç®¡ç†è€…"]');
                actorBtn.click();
                await sleep(500);
                
                // ã‚³ãƒ¼ãƒ‰ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
                const codeArea = appDocument.getElementById('plantuml-code');
                const code = codeArea.value;
                
                // ã‚³ãƒ¼ãƒ‰ç·¨é›†â†’GUIæ›´æ–°
                const newCode = code.replace('@enduml', 'ç®¡ç†è€… -> ã‚·ã‚¹ãƒ†ãƒ  : ãƒ­ã‚°ã‚¤ãƒ³\n@enduml');
                codeArea.value = newCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                await sleep(1000);
                
                return 'åŒæ–¹å‘åŒæœŸãƒ†ã‚¹ãƒˆå®Œäº†';
            });
        }

        // 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ
        async function runErrorHandlingTests() {
            console.log('âš ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            // æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãƒ†ã‚¹ãƒˆ
            await runTest('test-syntax-error', async () => {
                const codeArea = appDocument.getElementById('plantuml-code');
                
                // ä¸æ­£ãªæ§‹æ–‡ã‚’å…¥åŠ›
                const invalidCode = `@startuml
ã“ã‚Œã¯ä¸æ­£ãªæ§‹æ–‡ã§ã™
actor -> 
loop without end
@enduml`;
                
                codeArea.value = invalidCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                await sleep(1000);
                
                // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãŒå‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèª
                if (appWindow.globalErrorHandler) {
                    const errors = appWindow.globalErrorHandler.getErrors();
                    console.log('æ¤œå‡ºã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼æ•°:', errors.length);
                }
                
                // ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
                const errorDialog = appDocument.querySelector('.error-dialog');
                if (errorDialog) {
                    console.log('ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸ');
                }
                
                return 'æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†';
            });
            
            // è‡ªå‹•å¾©æ—§ãƒ†ã‚¹ãƒˆ
            await runTest('test-auto-recovery', async () => {
                // ãƒ¡ãƒ¢ãƒªã‚¨ãƒ©ãƒ¼ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                if (appWindow.globalErrorHandler) {
                    await appWindow.globalErrorHandler.handleError({
                        type: 'memory',
                        message: 'ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³',
                        severity: 'high'
                    });
                }
                
                await sleep(2000);
                
                // å¾©æ—§ãŒè©¦è¡Œã•ã‚ŒãŸã‹ç¢ºèª
                if (appWindow.globalErrorHandler) {
                    const metrics = appWindow.globalErrorHandler.getMetrics();
                    console.log('å¾©æ—§å¯èƒ½ã‚¨ãƒ©ãƒ¼æ•°:', metrics.recoverableErrors);
                }
                
                return 'è‡ªå‹•å¾©æ—§ãƒ†ã‚¹ãƒˆå®Œäº†';
            });
            
            // ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ†ã‚¹ãƒˆ
            await runTest('test-error-dialog', async () => {
                // è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                if (appWindow.globalErrorHandler) {
                    appWindow.globalErrorHandler.handleCriticalError({
                        id: 'test-critical',
                        timestamp: new Date().toISOString(),
                        message: 'ãƒ†ã‚¹ãƒˆç”¨è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼',
                        type: 'critical',
                        severity: 'critical'
                    });
                }
                
                await sleep(1000);
                
                // ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹
                const criticalDialog = appDocument.querySelector('.error-dialog.critical');
                if (criticalDialog) {
                    console.log('è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã¾ã—ãŸ');
                    // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹
                    const closeBtn = criticalDialog.querySelector('button');
                    if (closeBtn) closeBtn.click();
                }
                
                return 'ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ†ã‚¹ãƒˆå®Œäº†';
            });
        }

        // 3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
        async function runPerformanceTests() {
            console.log('âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            // å¤§è¦æ¨¡å›³å‡¦ç†ãƒ†ã‚¹ãƒˆ
            await runTest('test-large-diagram', async () => {
                const codeArea = appDocument.getElementById('plantuml-code');
                
                // 1000è¡Œã®å¤§è¦æ¨¡PlantUMLã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
                let largeCode = '@startuml\n';
                for (let i = 0; i < 100; i++) {
                    largeCode += `actor User${i}\n`;
                    largeCode += `participant System${i}\n`;
                }
                for (let i = 0; i < 400; i++) {
                    const from = Math.floor(Math.random() * 100);
                    const to = Math.floor(Math.random() * 100);
                    largeCode += `User${from} -> System${to} : Message ${i}\n`;
                }
                largeCode += '@enduml';
                
                // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šé–‹å§‹
                const startTime = performance.now();
                
                codeArea.value = largeCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                
                await sleep(3000); // å‡¦ç†å®Œäº†ã‚’å¾…ã¤
                
                const endTime = performance.now();
                const processingTime = Math.round(endTime - startTime);
                
                // ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
                document.getElementById('render-time').textContent = processingTime + 'ms';
                
                // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç¢ºèª
                if (appWindow.globalPerformanceOptimizer) {
                    const metrics = appWindow.globalPerformanceOptimizer.getMetrics();
                    if (metrics.memory) {
                        document.getElementById('memory-mb').textContent = metrics.memory.used + 'MB';
                        const usagePercent = Math.round((metrics.memory.used / metrics.memory.limit) * 100);
                        document.getElementById('memory-usage').style.width = usagePercent + '%';
                        document.getElementById('memory-usage').textContent = usagePercent + '%';
                    }
                }
                
                return `å¤§è¦æ¨¡å›³å‡¦ç†å®Œäº†: ${processingTime}ms`;
            });
            
            // é«˜é€Ÿæ›´æ–°ãƒ†ã‚¹ãƒˆ
            await runTest('test-rapid-updates', async () => {
                const codeArea = appDocument.getElementById('plantuml-code');
                const updateCount = 50;
                const startTime = performance.now();
                
                for (let i = 0; i < updateCount; i++) {
                    const code = `@startuml
actor User
participant System
User -> System : Update ${i}
@enduml`;
                    codeArea.value = code;
                    codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                    await sleep(50); // 50msé–“éš”ã§æ›´æ–°
                }
                
                const endTime = performance.now();
                const totalTime = Math.round(endTime - startTime);
                const avgTime = Math.round(totalTime / updateCount);
                
                return `é«˜é€Ÿæ›´æ–°ãƒ†ã‚¹ãƒˆå®Œäº†: å¹³å‡${avgTime}ms/æ›´æ–°`;
            });
        }

        // 4. å…¥åŠ›æ¤œè¨¼ãƒ†ã‚¹ãƒˆ
        async function runValidationTests() {
            console.log('âœ… å…¥åŠ›æ¤œè¨¼ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            // æ—¥æœ¬èªæ¤œè¨¼ãƒ†ã‚¹ãƒˆ
            await runTest('test-japanese-validation', async () => {
                if (appWindow.globalValidationEngine) {
                    const result = await appWindow.globalValidationEngine.validate({
                        input: 'é¡§å®¢ãŒECã«æ³¨æ–‡ã‚’é€ã‚‹',
                        type: 'japanese'
                    });
                    
                    console.log('æ—¥æœ¬èªæ¤œè¨¼çµæœ:', result);
                    
                    if (result.isValid) {
                        return 'æ—¥æœ¬èªæ¤œè¨¼æˆåŠŸ';
                    } else {
                        return `æ—¥æœ¬èªæ¤œè¨¼: ${result.errors.length}ä»¶ã®ã‚¨ãƒ©ãƒ¼æ¤œå‡º`;
                    }
                }
                
                return 'æ—¥æœ¬èªæ¤œè¨¼æ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“';
            });
            
            // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
            await runTest('test-security-check', async () => {
                const maliciousCode = `@startuml
actor Hacker
participant System
Hacker -> System : <script>alert('XSS')</script>
Hacker -> System : '; DROP TABLE users; --
@enduml`;
                
                if (appWindow.globalValidationEngine) {
                    const vulnerabilities = await appWindow.globalValidationEngine.detectSecurityVulnerabilities(maliciousCode);
                    console.log('æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§:', vulnerabilities);
                    
                    if (vulnerabilities.length > 0) {
                        return `ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ã‚’${vulnerabilities.length}ä»¶æ¤œå‡º`;
                    }
                }
                
                return 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯å®Œäº†';
            });
            
            // è‡ªå‹•ä¿®æ­£ãƒ†ã‚¹ãƒˆ
            await runTest('test-auto-fix', async () => {
                const brokenCode = `@startuml
actor é¡§å®¢
é¡§å®¢ -> 
loop
@enduml`;
                
                if (appWindow.globalValidationEngine) {
                    const fixed = await appWindow.globalValidationEngine.autoFix(brokenCode);
                    console.log('è‡ªå‹•ä¿®æ­£çµæœ:', fixed);
                    
                    if (fixed.hasChanges) {
                        return `${fixed.fixCount}ä»¶ã®å•é¡Œã‚’è‡ªå‹•ä¿®æ­£`;
                    }
                }
                
                return 'è‡ªå‹•ä¿®æ­£ãƒ†ã‚¹ãƒˆå®Œäº†';
            });
        }

        // 5. ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ
        async function runStressTests() {
            console.log('ğŸ’ª ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆé–‹å§‹');
            
            // ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ
            await runTest('test-memory-leak', async () => {
                const iterations = 100;
                const initialMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                
                for (let i = 0; i < iterations; i++) {
                    // DOMè¦ç´ ã®ä½œæˆã¨å‰Šé™¤ã‚’ç¹°ã‚Šè¿”ã™
                    const div = appDocument.createElement('div');
                    div.className = 'test-element-' + i;
                    div.innerHTML = '<span>Test ' + i + '</span>';
                    appDocument.body.appendChild(div);
                    
                    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
                    div.addEventListener('click', function() {
                        console.log('Click ' + i);
                    });
                    
                    // å‰Šé™¤
                    setTimeout(() => {
                        div.remove();
                    }, 10);
                    
                    if (i % 10 === 0) {
                        await sleep(100);
                    }
                }
                
                await sleep(2000);
                
                const finalMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                const memoryIncrease = Math.round((finalMemory - initialMemory) / 1024 / 1024);
                
                console.log(`ãƒ¡ãƒ¢ãƒªå¢—åŠ : ${memoryIncrease}MB`);
                
                if (memoryIncrease > 50) {
                    throw new Error('ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™');
                }
                
                return 'ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆåˆæ ¼';
            });
            
            // ä¸¦è¡Œæ“ä½œãƒ†ã‚¹ãƒˆ
            await runTest('test-concurrent-ops', async () => {
                const promises = [];
                
                // 10å€‹ã®ä¸¦è¡Œæ“ä½œã‚’å®Ÿè¡Œ
                for (let i = 0; i < 10; i++) {
                    promises.push((async () => {
                        const codeArea = appDocument.getElementById('plantuml-code');
                        const code = `@startuml
actor User${i}
participant System${i}
User${i} -> System${i} : Message ${i}
@enduml`;
                        codeArea.value = code;
                        codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                    })());
                }
                
                await Promise.all(promises);
                await sleep(1000);
                
                return 'ä¸¦è¡Œæ“ä½œãƒ†ã‚¹ãƒˆå®Œäº†';
            });
            
            // æ¥µé™è² è·ãƒ†ã‚¹ãƒˆ
            await runTest('test-extreme-load', async () => {
                // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚’å¼·åˆ¶å®Ÿè¡Œ
                if (appWindow.globalPerformanceOptimizer) {
                    await appWindow.globalPerformanceOptimizer.optimize({ forceAll: true });
                }
                
                // æ¥µé™ã‚µã‚¤ã‚ºã®ãƒ‡ãƒ¼ã‚¿
                let extremeCode = '@startuml\n';
                for (let i = 0; i < 500; i++) {
                    extremeCode += `actor VeryLongActorName${i}WithExtremelyLongIdentifier\n`;
                    extremeCode += `participant VeryLongSystemName${i}WithExtremelyLongIdentifier\n`;
                    
                    if (i > 0) {
                        extremeCode += `VeryLongActorName${i-1}WithExtremelyLongIdentifier -> VeryLongSystemName${i}WithExtremelyLongIdentifier : ExtremelongMessageTextThatContainsLotsOfInformation${i}\n`;
                    }
                }
                extremeCode += '@enduml';
                
                const startTime = performance.now();
                const codeArea = appDocument.getElementById('plantuml-code');
                codeArea.value = extremeCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                
                await sleep(5000);
                
                const endTime = performance.now();
                const processingTime = Math.round(endTime - startTime);
                
                if (processingTime > 10000) {
                    console.warn('å‡¦ç†æ™‚é–“ãŒ10ç§’ã‚’è¶…ãˆã¾ã—ãŸ');
                }
                
                return `æ¥µé™è² è·ãƒ†ã‚¹ãƒˆå®Œäº†: ${processingTime}ms`;
            });
        }

        // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ˜ãƒ«ãƒ‘ãƒ¼
        async function runTest(testId, testFunc) {
            const testCase = document.getElementById(testId);
            const statusDiv = testCase.querySelector('.test-status');
            const outputDiv = testCase.querySelector('.test-output');
            
            testResults.total++;
            
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å®Ÿè¡Œä¸­ã«æ›´æ–°
            statusDiv.className = 'test-status status-running';
            statusDiv.textContent = 'å®Ÿè¡Œä¸­...';
            
            try {
                const result = await testFunc();
                
                // æˆåŠŸ
                testResults.passed++;
                statusDiv.className = 'test-status status-passed';
                statusDiv.textContent = 'æˆåŠŸ';
                outputDiv.style.display = 'block';
                outputDiv.textContent = result;
                
                testResults.details.push({
                    id: testId,
                    status: 'passed',
                    message: result
                });
                
                console.log(`âœ… ${testId}: ${result}`);
            } catch (error) {
                // å¤±æ•—
                testResults.failed++;
                statusDiv.className = 'test-status status-failed';
                statusDiv.textContent = 'å¤±æ•—';
                outputDiv.style.display = 'block';
                outputDiv.textContent = `ã‚¨ãƒ©ãƒ¼: ${error.message}`;
                
                testResults.details.push({
                    id: testId,
                    status: 'failed',
                    message: error.message
                });
                
                console.error(`âŒ ${testId}: ${error.message}`);
            }
            
            updateStatistics();
        }

        // çµ±è¨ˆæ›´æ–°
        function updateStatistics() {
            document.getElementById('total-tests').textContent = testResults.total;
            document.getElementById('passed-tests').textContent = testResults.passed;
            document.getElementById('failed-tests').textContent = testResults.failed;
            document.getElementById('coverage').textContent = 
                testResults.total > 0 ? Math.round((testResults.passed / testResults.total) * 100) + '%' : '0%';
            document.getElementById('exec-time').textContent = testResults.executionTime + 'ms';
        }

        // ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        function generateReport() {
            const report = {
                timestamp: new Date().toISOString(),
                summary: {
                    total: testResults.total,
                    passed: testResults.passed,
                    failed: testResults.failed,
                    coverage: Math.round((testResults.passed / testResults.total) * 100),
                    executionTime: testResults.executionTime
                },
                details: testResults.details,
                environment: {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    memory: performance.memory ? {
                        used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024),
                        total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024),
                        limit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)
                    } : null
                }
            };
            
            console.log('ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ:', report);
            
            // ãƒ¬ãƒãƒ¼ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `test-report-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            // æˆåŠŸç‡ã«å¿œã˜ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            if (report.summary.coverage === 100) {
                alert('ğŸ‰ å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸï¼å®Œç’§ã§ã™ï¼');
            } else if (report.summary.coverage >= 80) {
                alert('âœ… ãƒ†ã‚¹ãƒˆæˆåŠŸç‡: ' + report.summary.coverage + '%\nè‰¯å¥½ãªçµæœã§ã™ã€‚');
            } else {
                alert('âš ï¸ ãƒ†ã‚¹ãƒˆæˆåŠŸç‡: ' + report.summary.coverage + '%\næ”¹å–„ãŒå¿…è¦ã§ã™ã€‚');
            }
        }

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                runAllTests();
            }
        });
    </script>
</body>
</html>