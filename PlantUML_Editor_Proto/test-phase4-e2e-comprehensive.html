<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 4 - ÂåÖÊã¨ÁöÑE2E„ÉÜ„Çπ„Éà„Çπ„Ç§„Éº„Éà</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .test-header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .test-header h1 {
            margin: 0;
            font-size: 32px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .test-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #6c757d;
            margin-top: 5px;
        }
        
        .test-sections {
            padding: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid #3498db;
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .test-case {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .test-case:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .test-case h3 {
            margin-top: 0;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .test-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .status-pending {
            background: #ffc107;
            color: #856404;
        }
        
        .status-running {
            background: #17a2b8;
            color: white;
            animation: pulse 1.5s infinite;
        }
        
        .status-passed {
            background: #28a745;
            color: white;
        }
        
        .status-failed {
            background: #dc3545;
            color: white;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .test-output {
            background: #2c3e50;
            color: #1abc9c;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            padding: 20px;
            background: #e9ecef;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .performance-chart {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .memory-bar {
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .memory-usage {
            height: 100%;
            background: linear-gradient(90deg, #43e97b 0%, #ffc107 50%, #f5576c 100%);
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .error-log {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
        }
        
        .success-log {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
        }
        
        .icon {
            font-size: 24px;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            stroke-dasharray: 339.292;
            stroke-dashoffset: 339.292;
            animation: progress 2s ease-out forwards;
        }
        
        @keyframes progress {
            to {
                stroke-dashoffset: 0;
            }
        }

        .test-iframe {
            width: 100%;
            height: 600px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            margin-top: 20px;
        }

        .scenario-description {
            background: #e8f4fd;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .metric-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }

        .metric-label {
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üöÄ Phase 4 - ÂåÖÊã¨ÁöÑE2E„ÉÜ„Çπ„Éà„Çπ„Ç§„Éº„Éà</h1>
            <p>PlantUML„Ç®„Éá„Ç£„Çø„ÅÆÂÆåÂÖ®„Å™Áµ±Âêà„ÉÜ„Çπ„Éà</p>
        </div>

        <div class="test-stats">
            <div class="stat-card">
                <div class="stat-value" id="total-tests">0</div>
                <div class="stat-label">Á∑è„ÉÜ„Çπ„ÉàÊï∞</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="passed-tests">0</div>
                <div class="stat-label">ÊàêÂäü</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="failed-tests">0</div>
                <div class="stat-label">Â§±Êïó</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="coverage">0%</div>
                <div class="stat-label">„Ç´„Éê„É¨„ÉÉ„Ç∏</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="exec-time">0ms</div>
                <div class="stat-label">ÂÆüË°åÊôÇÈñì</div>
            </div>
        </div>

        <div class="test-controls">
            <button class="btn btn-primary" onclick="runAllTests()">
                ‚ñ∂Ô∏è ÂÖ®„ÉÜ„Çπ„ÉàÂÆüË°å
            </button>
            <button class="btn btn-success" onclick="runIntegrationTests()">
                üîó Áµ±Âêà„ÉÜ„Çπ„Éà
            </button>
            <button class="btn btn-danger" onclick="runStressTests()">
                üí™ „Çπ„Éà„É¨„Çπ„ÉÜ„Çπ„Éà
            </button>
            <button class="btn btn-primary" onclick="generateReport()">
                üìä „É¨„Éù„Éº„ÉàÁîüÊàê
            </button>
        </div>

        <!-- „ÉÜ„Çπ„ÉàÁî®iframeÔºàÂÆüÈöõ„ÅÆ„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ôºâ -->
        <div style="padding: 20px;">
            <h3>üì± „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ë°®Á§∫„Ç®„É™„Ç¢</h3>
            <iframe id="app-frame" class="test-iframe" src="http://localhost:8083/index.html"></iframe>
        </div>

        <div class="test-sections">
            <!-- 1. Áµ±Âêà„ÉÜ„Çπ„Éà -->
            <div class="test-section">
                <h2><span class="icon">üîó</span> Áµ±Âêà„ÉÜ„Çπ„Éà (Integration Tests)</h2>
                <div class="scenario-description">
                    <strong>„Ç∑„Éä„É™„Ç™:</strong> ÂÆüÈöõ„ÅÆ„É¶„Éº„Ç∂„Éº„Éï„É≠„Éº„ÇíÂÆåÂÖ®„Å´ÂÜçÁèæ„Åó„ÄÅ„Ç¢„ÇØ„Çø„ÉºÈÅ∏Êäû„Åã„ÇâÂõ≥„ÅÆÁîüÊàê„Åæ„Åß„ÅÆÂÖ®„Éó„É≠„Çª„Çπ„ÇíÊ§úË®º
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-basic-flow">
                        <h3>üìù Âü∫Êú¨„Éï„É≠„Éº</h3>
                        <p>„Ç¢„ÇØ„Çø„ÉºÈÅ∏Êäû‚ÜíÂá¶ÁêÜËøΩÂä†‚Üí„Ç≥„Éº„ÉâÁîüÊàê‚Üí„Éó„É¨„Éì„É•„ÉºË°®Á§∫</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-complex-structures">
                        <h3>üèóÔ∏è Ë§áÈõëÊßãÈÄ†</h3>
                        <p>„É´„Éº„Éó„ÄÅÊù°‰ª∂ÂàÜÂ≤ê„ÄÅ‰∏¶Ë°åÂá¶ÁêÜ„ÇíÂê´„ÇÄÂõ≥„ÅÆÁîüÊàê</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-bidirectional-sync">
                        <h3>üîÑ ÂèåÊñπÂêëÂêåÊúü</h3>
                        <p>„Ç≥„Éº„ÉâÁ∑®ÈõÜ‚ÜíGUIÊõ¥Êñ∞„ÄÅGUIÊìç‰Ωú‚Üí„Ç≥„Éº„ÉâÊõ¥Êñ∞</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 2. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÉÜ„Çπ„Éà -->
            <div class="test-section">
                <h2><span class="icon">‚ö†Ô∏è</span> „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÉÜ„Çπ„Éà</h2>
                <div class="scenario-description">
                    <strong>„Ç∑„Éä„É™„Ç™:</strong> Êßò„ÄÖ„Å™„Ç®„É©„ÉºÁä∂Ê≥Å„ÇíÊÑèÂõ≥ÁöÑ„Å´Áô∫Áîü„Åï„Åõ„ÄÅÈÅ©Âàá„Å™„Ç®„É©„ÉºÂá¶ÁêÜ„Å®Âæ©ÊóßÊ©üËÉΩ„ÇíÊ§úË®º
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-syntax-error">
                        <h3>‚ùå ÊßãÊñá„Ç®„É©„Éº</h3>
                        <p>‰∏çÊ≠£„Å™PlantUMLÊßãÊñá„ÅÆÂÖ•Âäõ„Å®Ê§úÂá∫</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-auto-recovery">
                        <h3>üîß Ëá™ÂãïÂæ©Êóß</h3>
                        <p>„Ç®„É©„ÉºÁô∫ÁîüÂæå„ÅÆËá™ÂãïÂæ©ÊóßÊ©üËÉΩ</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-error-dialog">
                        <h3>üí¨ „Ç®„É©„Éº„ÉÄ„Ç§„Ç¢„É≠„Ç∞</h3>
                        <p>„É¶„Éº„Ç∂„Éº„Å∏„ÅÆ„Ç®„É©„ÉºÈÄöÁü•Ê©üËÉΩ</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 3. „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„Éà -->
            <div class="test-section">
                <h2><span class="icon">‚ö°</span> „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„Éà</h2>
                <div class="scenario-description">
                    <strong>„Ç∑„Éä„É™„Ç™:</strong> Â§ßÈáè„Éá„Éº„ÇøÂá¶ÁêÜ„Å®„É¨„Çπ„Éù„É≥„ÇπÊôÇÈñì„ÇíÊ∏¨ÂÆö„Åó„ÄÅ„Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©ÂåñÊ©üËÉΩ„ÇíÊ§úË®º
                </div>
                
                <div class="performance-chart">
                    <h4>„É°„É¢„É™‰ΩøÁî®Èáè</h4>
                    <div class="memory-bar">
                        <div class="memory-usage" id="memory-usage">0%</div>
                    </div>
                </div>
                
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="render-time">0ms</div>
                        <div class="metric-label">„É¨„É≥„ÉÄ„É™„É≥„Ç∞ÊôÇÈñì</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="memory-mb">0MB</div>
                        <div class="metric-label">„É°„É¢„É™‰ΩøÁî®Èáè</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="cpu-usage">0%</div>
                        <div class="metric-label">CPU‰ΩøÁî®Áéá</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="cache-hit">0%</div>
                        <div class="metric-label">„Ç≠„É£„ÉÉ„Ç∑„É•„Éí„ÉÉ„ÉàÁéá</div>
                    </div>
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-large-diagram">
                        <h3>üìä Â§ßË¶èÊ®°Âõ≥Âá¶ÁêÜ</h3>
                        <p>1000Ë°å„ÅÆPlantUML„Ç≥„Éº„ÉâÂá¶ÁêÜ</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-rapid-updates">
                        <h3>‚ö° È´òÈÄüÊõ¥Êñ∞</h3>
                        <p>ÈÄ£Á∂öÁöÑ„Å™Êõ¥Êñ∞„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 4. ÂÖ•ÂäõÊ§úË®º„ÉÜ„Çπ„Éà -->
            <div class="test-section">
                <h2><span class="icon">‚úÖ</span> ÂÖ•ÂäõÊ§úË®º„ÉÜ„Çπ„Éà</h2>
                <div class="scenario-description">
                    <strong>„Ç∑„Éä„É™„Ç™:</strong> Êßò„ÄÖ„Å™ÂÖ•Âäõ„Éë„Çø„Éº„É≥„Å´ÂØæ„Åô„Çã„Éê„É™„Éá„Éº„Ç∑„Éß„É≥Ê©üËÉΩ„Å®Ëá™Âãï‰øÆÊ≠£Ê©üËÉΩ„ÇíÊ§úË®º
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-japanese-validation">
                        <h3>üáØüáµ Êó•Êú¨Ë™ûÊ§úË®º</h3>
                        <p>Êó•Êú¨Ë™ûÊñáÊ≥ï„ÅÆÊ§úË®º„Å®‰øÆÊ≠£</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-security-check">
                        <h3>üîí „Çª„Ç≠„É•„É™„ÉÜ„Ç£</h3>
                        <p>ÊÇ™ÊÑè„ÅÆ„ÅÇ„ÇãÂÖ•Âäõ„ÅÆÊ§úÂá∫</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-auto-fix">
                        <h3>üîß Ëá™Âãï‰øÆÊ≠£</h3>
                        <p>‰∏ÄËà¨ÁöÑ„Å™„Ç®„É©„Éº„ÅÆËá™Âãï‰øÆÊ≠£</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>

            <!-- 5. „Çπ„Éà„É¨„Çπ„ÉÜ„Çπ„Éà -->
            <div class="test-section">
                <h2><span class="icon">üí™</span> „Çπ„Éà„É¨„Çπ„ÉÜ„Çπ„Éà</h2>
                <div class="scenario-description">
                    <strong>„Ç∑„Éä„É™„Ç™:</strong> Ê•µÈôêÁä∂Ê≥Å‰∏ã„Åß„ÅÆ„Ç∑„Çπ„ÉÜ„É†ÂÆâÂÆöÊÄß„Å®„É°„É¢„É™„É™„Éº„ÇØ„ÅÆÊ§úË®º
                </div>
                
                <div class="test-grid">
                    <div class="test-case" id="test-memory-leak">
                        <h3>üíæ „É°„É¢„É™„É™„Éº„ÇØ</h3>
                        <p>Èï∑ÊôÇÈñìÂãï‰Ωú„Åß„ÅÆ„É°„É¢„É™„É™„Éº„ÇØÊ§úË®º</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-concurrent-ops">
                        <h3>üîÄ ‰∏¶Ë°åÊìç‰Ωú</h3>
                        <p>Ë§áÊï∞„ÅÆÂêåÊôÇÊìç‰Ωú„ÅÆÂá¶ÁêÜ</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                    
                    <div class="test-case" id="test-extreme-load">
                        <h3>üåã Ê•µÈôêË≤†Ëç∑</h3>
                        <p>„Ç∑„Çπ„ÉÜ„É†ÈôêÁïå„Åæ„Åß„ÅÆË≤†Ëç∑„ÉÜ„Çπ„Éà</p>
                        <div class="test-status status-pending">ÂæÖÊ©ü‰∏≠</div>
                        <div class="test-output" style="display:none;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            coverage: 0,
            executionTime: 0,
            details: []
        };

        let appFrame = null;
        let appWindow = null;
        let appDocument = null;

        // „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Éï„É¨„Éº„É†„ÅÆÂàùÊúüÂåñ
        window.onload = function() {
            appFrame = document.getElementById('app-frame');
            appFrame.onload = function() {
                appWindow = appFrame.contentWindow;
                appDocument = appFrame.contentDocument;
                console.log('‚úÖ „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Éï„É¨„Éº„É†ÂàùÊúüÂåñÂÆå‰∫Ü');
            };
        };

        // „ÉÜ„Çπ„ÉàÂÆüË°åÈñ¢Êï∞
        async function runAllTests() {
            console.log('üöÄ ÂÖ®„ÉÜ„Çπ„ÉàÂÆüË°åÈñãÂßã');
            const startTime = Date.now();
            
            // Áµ±Ë®à„É™„Çª„ÉÉ„Éà
            testResults = {
                total: 0,
                passed: 0,
                failed: 0,
                coverage: 0,
                executionTime: 0,
                details: []
            };

            // ÂêÑ„ÉÜ„Çπ„Éà„Ç´„ÉÜ„Ç¥„É™„ÇíÈ†ÜÊ¨°ÂÆüË°å
            await runIntegrationTests();
            await sleep(1000);
            await runErrorHandlingTests();
            await sleep(1000);
            await runPerformanceTests();
            await sleep(1000);
            await runValidationTests();
            await sleep(1000);
            await runStressTests();
            
            // Áµ±Ë®àÊõ¥Êñ∞
            testResults.executionTime = Date.now() - startTime;
            testResults.coverage = Math.round((testResults.passed / testResults.total) * 100);
            updateStatistics();
            
            console.log('‚úÖ ÂÖ®„ÉÜ„Çπ„ÉàÂÆå‰∫Ü');
            generateReport();
        }

        // 1. Áµ±Âêà„ÉÜ„Çπ„Éà
        async function runIntegrationTests() {
            console.log('üîó Áµ±Âêà„ÉÜ„Çπ„ÉàÈñãÂßã');
            
            // Âü∫Êú¨„Éï„É≠„Éº„ÉÜ„Çπ„Éà
            await runTest('test-basic-flow', async () => {
                // „Ç¢„ÇØ„Çø„Éº„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ
                const actorBtn = appDocument.querySelector('[data-actor="È°ßÂÆ¢"]');
                if (!actorBtn) throw new Error('„Ç¢„ÇØ„Çø„Éº„Éú„Çø„É≥„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                actorBtn.click();
                await sleep(500);
                
                // „ÇÇ„ÅÜ1„Å§„Ç¢„ÇØ„Çø„Éº„ÇíËøΩÂä†
                const actorBtn2 = appDocument.querySelector('[data-actor="EC„Çµ„Ç§„Éà"]');
                actorBtn2.click();
                await sleep(500);
                
                // Âá¶ÁêÜ„ÇíÂÖ•Âäõ
                const fromSelect = appDocument.getElementById('from-actor');
                const toSelect = appDocument.getElementById('to-actor');
                const actionInput = appDocument.getElementById('action-text');
                
                fromSelect.value = 'È°ßÂÆ¢';
                toSelect.value = 'EC„Çµ„Ç§„Éà';
                actionInput.value = 'ÂïÜÂìÅ„ÇíÊ≥®Êñá„Åô„Çã';
                
                // ËøΩÂä†„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ
                const addBtn = appDocument.querySelector('.btn-add-action');
                addBtn.click();
                await sleep(500);
                
                // PlantUML„Ç≥„Éº„Éâ„ÅåÁîüÊàê„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
                const codeArea = appDocument.getElementById('plantuml-code');
                const code = codeArea.value;
                
                if (!code.includes('È°ßÂÆ¢') || !code.includes('EC„Çµ„Ç§„Éà')) {
                    throw new Error('PlantUML„Ç≥„Éº„Éâ„ÅåÊ≠£„Åó„ÅèÁîüÊàê„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                }
                
                // „Éó„É¨„Éì„É•„Éº„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
                const preview = appDocument.getElementById('preview-svg');
                if (!preview.querySelector('svg') && !preview.querySelector('img')) {
                    console.warn('„Éó„É¨„Éì„É•„Éº„Åå„Åæ„Å†ÁîüÊàê„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„ÇìÔºà„É¨„É≥„ÉÄ„É™„É≥„Ç∞APIÊú™Êé•Á∂ö„ÅÆÂèØËÉΩÊÄßÔºâ');
                }
                
                return 'Âü∫Êú¨„Éï„É≠„Éº„ÉÜ„Çπ„ÉàÊàêÂäü';
            });
            
            // Ë§áÈõëÊßãÈÄ†„ÉÜ„Çπ„Éà
            await runTest('test-complex-structures', async () => {
                // „Ç≥„Éº„Éâ„Ç®„É™„Ç¢„Å´Áõ¥Êé•Ë§áÈõë„Å™ÊßãÈÄ†„ÇíÂÖ•Âäõ
                const codeArea = appDocument.getElementById('plantuml-code');
                const complexCode = `@startuml
actor È°ßÂÆ¢
participant EC„Çµ„Ç§„Éà
participant Âú®Â∫´ÁÆ°ÁêÜ

È°ßÂÆ¢ -> EC„Çµ„Ç§„Éà : Ê≥®Êñá
EC„Çµ„Ç§„Éà -> Âú®Â∫´ÁÆ°ÁêÜ : Âú®Â∫´Á¢∫Ë™ç

alt Âú®Â∫´„ÅÇ„Çä
    Âú®Â∫´ÁÆ°ÁêÜ --> EC„Çµ„Ç§„Éà : OK
    EC„Çµ„Ç§„Éà -> È°ßÂÆ¢ : Ê≥®ÊñáÁ¢∫ÂÆö
else Âú®Â∫´„Å™„Åó
    Âú®Â∫´ÁÆ°ÁêÜ --> EC„Çµ„Ç§„Éà : NG
    EC„Çµ„Ç§„Éà -> È°ßÂÆ¢ : Âú®Â∫´Âàá„ÇåÈÄöÁü•
end

loop 3Âõû„Åæ„Åß
    È°ßÂÆ¢ -> EC„Çµ„Ç§„Éà : ÂÜçË©¶Ë°å
end

@enduml`;
                
                // „Ç≥„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Ç§„Éô„É≥„Éà„ÇíÁô∫ÁÅ´
                codeArea.value = complexCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                await sleep(1000);
                
                // GUI„Å´ÂèçÊò†„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™çÔºàPhase 3„ÅÆÊ©üËÉΩÔºâ
                const actionItems = appDocument.querySelector('.action-items');
                if (actionItems && actionItems.children.length === 0) {
                    console.warn('GUIÂêåÊúüÊ©üËÉΩ„Åå„Åæ„Å†Âãï‰Ωú„Åó„Å¶„ÅÑ„Å™„ÅÑÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô');
                }
                
                return 'Ë§áÈõëÊßãÈÄ†„ÉÜ„Çπ„ÉàÂÆå‰∫Ü';
            });
            
            // ÂèåÊñπÂêëÂêåÊúü„ÉÜ„Çπ„Éà
            await runTest('test-bidirectional-sync', async () => {
                // GUIÊìç‰Ωú‚Üí„Ç≥„Éº„ÉâÊõ¥Êñ∞
                const clearBtn = appDocument.querySelector('.btn-clear');
                clearBtn.click();
                await sleep(500);
                
                // „Ç¢„ÇØ„Çø„ÉºËøΩÂä†
                const actorBtn = appDocument.querySelector('[data-actor="ÁÆ°ÁêÜËÄÖ"]');
                actorBtn.click();
                await sleep(500);
                
                // „Ç≥„Éº„Éâ„ÅåÊõ¥Êñ∞„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
                const codeArea = appDocument.getElementById('plantuml-code');
                const code = codeArea.value;
                
                // „Ç≥„Éº„ÉâÁ∑®ÈõÜ‚ÜíGUIÊõ¥Êñ∞
                const newCode = code.replace('@enduml', 'ÁÆ°ÁêÜËÄÖ -> „Ç∑„Çπ„ÉÜ„É† : „É≠„Ç∞„Ç§„É≥\n@enduml');
                codeArea.value = newCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                await sleep(1000);
                
                return 'ÂèåÊñπÂêëÂêåÊúü„ÉÜ„Çπ„ÉàÂÆå‰∫Ü';
            });
        }

        // 2. „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÉÜ„Çπ„Éà
        async function runErrorHandlingTests() {
            console.log('‚ö†Ô∏è „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÉÜ„Çπ„ÉàÈñãÂßã');
            
            // ÊßãÊñá„Ç®„É©„Éº„ÉÜ„Çπ„Éà
            await runTest('test-syntax-error', async () => {
                const codeArea = appDocument.getElementById('plantuml-code');
                
                // ‰∏çÊ≠£„Å™ÊßãÊñá„ÇíÂÖ•Âäõ
                const invalidCode = `@startuml
„Åì„Çå„ÅØ‰∏çÊ≠£„Å™ÊßãÊñá„Åß„Åô
actor -> 
loop without end
@enduml`;
                
                codeArea.value = invalidCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                await sleep(1000);
                
                // „Ç®„É©„Éº„Éè„É≥„Éâ„É©„Éº„ÅåÂãï‰Ωú„Åó„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
                if (appWindow.globalErrorHandler) {
                    const errors = appWindow.globalErrorHandler.getErrors();
                    console.log('Ê§úÂá∫„Åï„Çå„Åü„Ç®„É©„ÉºÊï∞:', errors.length);
                }
                
                // „Ç®„É©„Éº„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç
                const errorDialog = appDocument.querySelector('.error-dialog');
                if (errorDialog) {
                    console.log('„Ç®„É©„Éº„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅåË°®Á§∫„Åï„Çå„Åæ„Åó„Åü');
                }
                
                return 'ÊßãÊñá„Ç®„É©„Éº„ÉÜ„Çπ„ÉàÂÆå‰∫Ü';
            });
            
            // Ëá™ÂãïÂæ©Êóß„ÉÜ„Çπ„Éà
            await runTest('test-auto-recovery', async () => {
                // „É°„É¢„É™„Ç®„É©„Éº„Çí„Ç∑„Éü„É•„É¨„Éº„Éà
                if (appWindow.globalErrorHandler) {
                    await appWindow.globalErrorHandler.handleError({
                        type: 'memory',
                        message: '„É°„É¢„É™‰∏çË∂≥„Ç®„É©„Éº„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥',
                        severity: 'high'
                    });
                }
                
                await sleep(2000);
                
                // Âæ©Êóß„ÅåË©¶Ë°å„Åï„Çå„Åü„ÅãÁ¢∫Ë™ç
                if (appWindow.globalErrorHandler) {
                    const metrics = appWindow.globalErrorHandler.getMetrics();
                    console.log('Âæ©ÊóßÂèØËÉΩ„Ç®„É©„ÉºÊï∞:', metrics.recoverableErrors);
                }
                
                return 'Ëá™ÂãïÂæ©Êóß„ÉÜ„Çπ„ÉàÂÆå‰∫Ü';
            });
            
            // „Ç®„É©„Éº„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÉÜ„Çπ„Éà
            await runTest('test-error-dialog', async () => {
                // Ëá¥ÂëΩÁöÑ„Ç®„É©„Éº„Çí„Ç∑„Éü„É•„É¨„Éº„Éà
                if (appWindow.globalErrorHandler) {
                    appWindow.globalErrorHandler.handleCriticalError({
                        id: 'test-critical',
                        timestamp: new Date().toISOString(),
                        message: '„ÉÜ„Çπ„ÉàÁî®Ëá¥ÂëΩÁöÑ„Ç®„É©„Éº',
                        type: 'critical',
                        severity: 'critical'
                    });
                }
                
                await sleep(1000);
                
                // „Ç®„É©„Éº„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Çã„Åã
                const criticalDialog = appDocument.querySelector('.error-dialog.critical');
                if (criticalDialog) {
                    console.log('Ëá¥ÂëΩÁöÑ„Ç®„É©„Éº„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÅåÊ≠£Â∏∏„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åó„Åü');
                    // „ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñâ„Åò„Çã
                    const closeBtn = criticalDialog.querySelector('button');
                    if (closeBtn) closeBtn.click();
                }
                
                return '„Ç®„É©„Éº„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÉÜ„Çπ„ÉàÂÆå‰∫Ü';
            });
        }

        // 3. „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„Éà
        async function runPerformanceTests() {
            console.log('‚ö° „Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÉÜ„Çπ„ÉàÈñãÂßã');
            
            // Â§ßË¶èÊ®°Âõ≥Âá¶ÁêÜ„ÉÜ„Çπ„Éà
            await runTest('test-large-diagram', async () => {
                const codeArea = appDocument.getElementById('plantuml-code');
                
                // 1000Ë°å„ÅÆÂ§ßË¶èÊ®°PlantUML„Ç≥„Éº„Éâ„ÇíÁîüÊàê
                let largeCode = '@startuml\n';
                for (let i = 0; i < 100; i++) {
                    largeCode += `actor User${i}\n`;
                    largeCode += `participant System${i}\n`;
                }
                for (let i = 0; i < 400; i++) {
                    const from = Math.floor(Math.random() * 100);
                    const to = Math.floor(Math.random() * 100);
                    largeCode += `User${from} -> System${to} : Message ${i}\n`;
                }
                largeCode += '@enduml';
                
                // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊ∏¨ÂÆöÈñãÂßã
                const startTime = performance.now();
                
                codeArea.value = largeCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                
                await sleep(3000); // Âá¶ÁêÜÂÆå‰∫Ü„ÇíÂæÖ„Å§
                
                const endTime = performance.now();
                const processingTime = Math.round(endTime - startTime);
                
                // „É°„Éà„É™„ÇØ„ÇπÊõ¥Êñ∞
                document.getElementById('render-time').textContent = processingTime + 'ms';
                
                // „É°„É¢„É™‰ΩøÁî®ÈáèÁ¢∫Ë™ç
                if (appWindow.globalPerformanceOptimizer) {
                    const metrics = appWindow.globalPerformanceOptimizer.getMetrics();
                    if (metrics.memory) {
                        document.getElementById('memory-mb').textContent = metrics.memory.used + 'MB';
                        const usagePercent = Math.round((metrics.memory.used / metrics.memory.limit) * 100);
                        document.getElementById('memory-usage').style.width = usagePercent + '%';
                        document.getElementById('memory-usage').textContent = usagePercent + '%';
                    }
                }
                
                return `Â§ßË¶èÊ®°Âõ≥Âá¶ÁêÜÂÆå‰∫Ü: ${processingTime}ms`;
            });
            
            // È´òÈÄüÊõ¥Êñ∞„ÉÜ„Çπ„Éà
            await runTest('test-rapid-updates', async () => {
                const codeArea = appDocument.getElementById('plantuml-code');
                const updateCount = 50;
                const startTime = performance.now();
                
                for (let i = 0; i < updateCount; i++) {
                    const code = `@startuml
actor User
participant System
User -> System : Update ${i}
@enduml`;
                    codeArea.value = code;
                    codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                    await sleep(50); // 50msÈñìÈöî„ÅßÊõ¥Êñ∞
                }
                
                const endTime = performance.now();
                const totalTime = Math.round(endTime - startTime);
                const avgTime = Math.round(totalTime / updateCount);
                
                return `È´òÈÄüÊõ¥Êñ∞„ÉÜ„Çπ„ÉàÂÆå‰∫Ü: Âπ≥Âùá${avgTime}ms/Êõ¥Êñ∞`;
            });
        }

        // 4. ÂÖ•ÂäõÊ§úË®º„ÉÜ„Çπ„Éà
        async function runValidationTests() {
            console.log('‚úÖ ÂÖ•ÂäõÊ§úË®º„ÉÜ„Çπ„ÉàÈñãÂßã');
            
            // Êó•Êú¨Ë™ûÊ§úË®º„ÉÜ„Çπ„Éà
            await runTest('test-japanese-validation', async () => {
                if (appWindow.globalValidationEngine) {
                    const result = await appWindow.globalValidationEngine.validate({
                        input: 'È°ßÂÆ¢„ÅåEC„Å´Ê≥®Êñá„ÇíÈÄÅ„Çã',
                        type: 'japanese'
                    });
                    
                    console.log('Êó•Êú¨Ë™ûÊ§úË®ºÁµêÊûú:', result);
                    
                    if (result.isValid) {
                        return 'Êó•Êú¨Ë™ûÊ§úË®ºÊàêÂäü';
                    } else {
                        return `Êó•Êú¨Ë™ûÊ§úË®º: ${result.errors.length}‰ª∂„ÅÆ„Ç®„É©„ÉºÊ§úÂá∫`;
                    }
                }
                
                return 'Êó•Êú¨Ë™ûÊ§úË®ºÊ©üËÉΩ„ÅåÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì';
            });
            
            // „Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØ„ÉÜ„Çπ„Éà
            await runTest('test-security-check', async () => {
                const maliciousCode = `@startuml
actor Hacker
participant System
Hacker -> System : <script>alert('XSS')</script>
Hacker -> System : '; DROP TABLE users; --
@enduml`;
                
                if (appWindow.globalValidationEngine) {
                    const vulnerabilities = await appWindow.globalValidationEngine.detectSecurityVulnerabilities(maliciousCode);
                    console.log('Ê§úÂá∫„Åï„Çå„ÅüËÑÜÂº±ÊÄß:', vulnerabilities);
                    
                    if (vulnerabilities.length > 0) {
                        return `„Çª„Ç≠„É•„É™„ÉÜ„Ç£ËÑÜÂº±ÊÄß„Çí${vulnerabilities.length}‰ª∂Ê§úÂá∫`;
                    }
                }
                
                return '„Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÉÅ„Çß„ÉÉ„ÇØÂÆå‰∫Ü';
            });
            
            // Ëá™Âãï‰øÆÊ≠£„ÉÜ„Çπ„Éà
            await runTest('test-auto-fix', async () => {
                const brokenCode = `@startuml
actor È°ßÂÆ¢
È°ßÂÆ¢ -> 
loop
@enduml`;
                
                if (appWindow.globalValidationEngine) {
                    const fixed = await appWindow.globalValidationEngine.autoFix(brokenCode);
                    console.log('Ëá™Âãï‰øÆÊ≠£ÁµêÊûú:', fixed);
                    
                    if (fixed.hasChanges) {
                        return `${fixed.fixCount}‰ª∂„ÅÆÂïèÈ°å„ÇíËá™Âãï‰øÆÊ≠£`;
                    }
                }
                
                return 'Ëá™Âãï‰øÆÊ≠£„ÉÜ„Çπ„ÉàÂÆå‰∫Ü';
            });
        }

        // 5. „Çπ„Éà„É¨„Çπ„ÉÜ„Çπ„Éà
        async function runStressTests() {
            console.log('üí™ „Çπ„Éà„É¨„Çπ„ÉÜ„Çπ„ÉàÈñãÂßã');
            
            // „É°„É¢„É™„É™„Éº„ÇØ„ÉÜ„Çπ„Éà
            await runTest('test-memory-leak', async () => {
                const iterations = 100;
                const initialMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                
                for (let i = 0; i < iterations; i++) {
                    // DOMË¶ÅÁ¥†„ÅÆ‰ΩúÊàê„Å®ÂâäÈô§„ÇíÁπ∞„ÇäËøî„Åô
                    const div = appDocument.createElement('div');
                    div.className = 'test-element-' + i;
                    div.innerHTML = '<span>Test ' + i + '</span>';
                    appDocument.body.appendChild(div);
                    
                    // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºËøΩÂä†
                    div.addEventListener('click', function() {
                        console.log('Click ' + i);
                    });
                    
                    // ÂâäÈô§
                    setTimeout(() => {
                        div.remove();
                    }, 10);
                    
                    if (i % 10 === 0) {
                        await sleep(100);
                    }
                }
                
                await sleep(2000);
                
                const finalMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;
                const memoryIncrease = Math.round((finalMemory - initialMemory) / 1024 / 1024);
                
                console.log(`„É°„É¢„É™Â¢óÂä†: ${memoryIncrease}MB`);
                
                if (memoryIncrease > 50) {
                    throw new Error('„É°„É¢„É™„É™„Éº„ÇØ„ÅÆÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô');
                }
                
                return '„É°„É¢„É™„É™„Éº„ÇØ„ÉÜ„Çπ„ÉàÂêàÊ†º';
            });
            
            // ‰∏¶Ë°åÊìç‰Ωú„ÉÜ„Çπ„Éà
            await runTest('test-concurrent-ops', async () => {
                const promises = [];
                
                // 10ÂÄã„ÅÆ‰∏¶Ë°åÊìç‰Ωú„ÇíÂÆüË°å
                for (let i = 0; i < 10; i++) {
                    promises.push((async () => {
                        const codeArea = appDocument.getElementById('plantuml-code');
                        const code = `@startuml
actor User${i}
participant System${i}
User${i} -> System${i} : Message ${i}
@enduml`;
                        codeArea.value = code;
                        codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                    })());
                }
                
                await Promise.all(promises);
                await sleep(1000);
                
                return '‰∏¶Ë°åÊìç‰Ωú„ÉÜ„Çπ„ÉàÂÆå‰∫Ü';
            });
            
            // Ê•µÈôêË≤†Ëç∑„ÉÜ„Çπ„Éà
            await runTest('test-extreme-load', async () => {
                // „Éë„Éï„Ç©„Éº„Éû„É≥„ÇπÊúÄÈÅ©Âåñ„ÇíÂº∑Âà∂ÂÆüË°å
                if (appWindow.globalPerformanceOptimizer) {
                    await appWindow.globalPerformanceOptimizer.optimize({ forceAll: true });
                }
                
                // Ê•µÈôê„Çµ„Ç§„Ç∫„ÅÆ„Éá„Éº„Çø
                let extremeCode = '@startuml\n';
                for (let i = 0; i < 500; i++) {
                    extremeCode += `actor VeryLongActorName${i}WithExtremelyLongIdentifier\n`;
                    extremeCode += `participant VeryLongSystemName${i}WithExtremelyLongIdentifier\n`;
                    
                    if (i > 0) {
                        extremeCode += `VeryLongActorName${i-1}WithExtremelyLongIdentifier -> VeryLongSystemName${i}WithExtremelyLongIdentifier : ExtremelongMessageTextThatContainsLotsOfInformation${i}\n`;
                    }
                }
                extremeCode += '@enduml';
                
                const startTime = performance.now();
                const codeArea = appDocument.getElementById('plantuml-code');
                codeArea.value = extremeCode;
                codeArea.dispatchEvent(new Event('input', { bubbles: true }));
                
                await sleep(5000);
                
                const endTime = performance.now();
                const processingTime = Math.round(endTime - startTime);
                
                if (processingTime > 10000) {
                    console.warn('Âá¶ÁêÜÊôÇÈñì„Åå10Áßí„ÇíË∂Ö„Åà„Åæ„Åó„Åü');
                }
                
                return `Ê•µÈôêË≤†Ëç∑„ÉÜ„Çπ„ÉàÂÆå‰∫Ü: ${processingTime}ms`;
            });
        }

        // „ÉÜ„Çπ„ÉàÂÆüË°å„Éò„É´„Éë„Éº
        async function runTest(testId, testFunc) {
            const testCase = document.getElementById(testId);
            const statusDiv = testCase.querySelector('.test-status');
            const outputDiv = testCase.querySelector('.test-output');
            
            testResults.total++;
            
            // „Çπ„ÉÜ„Éº„Çø„Çπ„ÇíÂÆüË°å‰∏≠„Å´Êõ¥Êñ∞
            statusDiv.className = 'test-status status-running';
            statusDiv.textContent = 'ÂÆüË°å‰∏≠...';
            
            try {
                const result = await testFunc();
                
                // ÊàêÂäü
                testResults.passed++;
                statusDiv.className = 'test-status status-passed';
                statusDiv.textContent = 'ÊàêÂäü';
                outputDiv.style.display = 'block';
                outputDiv.textContent = result;
                
                testResults.details.push({
                    id: testId,
                    status: 'passed',
                    message: result
                });
                
                console.log(`‚úÖ ${testId}: ${result}`);
            } catch (error) {
                // Â§±Êïó
                testResults.failed++;
                statusDiv.className = 'test-status status-failed';
                statusDiv.textContent = 'Â§±Êïó';
                outputDiv.style.display = 'block';
                outputDiv.textContent = `„Ç®„É©„Éº: ${error.message}`;
                
                testResults.details.push({
                    id: testId,
                    status: 'failed',
                    message: error.message
                });
                
                console.error(`‚ùå ${testId}: ${error.message}`);
            }
            
            updateStatistics();
        }

        // Áµ±Ë®àÊõ¥Êñ∞
        function updateStatistics() {
            document.getElementById('total-tests').textContent = testResults.total;
            document.getElementById('passed-tests').textContent = testResults.passed;
            document.getElementById('failed-tests').textContent = testResults.failed;
            document.getElementById('coverage').textContent = 
                testResults.total > 0 ? Math.round((testResults.passed / testResults.total) * 100) + '%' : '0%';
            document.getElementById('exec-time').textContent = testResults.executionTime + 'ms';
        }

        // „É¨„Éù„Éº„ÉàÁîüÊàê
        function generateReport() {
            const report = {
                timestamp: new Date().toISOString(),
                summary: {
                    total: testResults.total,
                    passed: testResults.passed,
                    failed: testResults.failed,
                    coverage: Math.round((testResults.passed / testResults.total) * 100),
                    executionTime: testResults.executionTime
                },
                details: testResults.details,
                environment: {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    memory: performance.memory ? {
                        used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024),
                        total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024),
                        limit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)
                    } : null
                }
            };
            
            console.log('üìä „ÉÜ„Çπ„Éà„É¨„Éù„Éº„Éà:', report);
            
            // „É¨„Éù„Éº„Éà„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `test-report-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            // ÊàêÂäüÁéá„Å´Âøú„Åò„Åü„É°„ÉÉ„Çª„Éº„Ç∏
            if (report.summary.coverage === 100) {
                alert('üéâ ÂÖ®„ÉÜ„Çπ„ÉàÊàêÂäüÔºÅÂÆåÁíß„Åß„ÅôÔºÅ');
            } else if (report.summary.coverage >= 80) {
                alert('‚úÖ „ÉÜ„Çπ„ÉàÊàêÂäüÁéá: ' + report.summary.coverage + '%\nËâØÂ•Ω„Å™ÁµêÊûú„Åß„Åô„ÄÇ');
            } else {
                alert('‚ö†Ô∏è „ÉÜ„Çπ„ÉàÊàêÂäüÁéá: ' + report.summary.coverage + '%\nÊîπÂñÑ„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ');
            }
        }

        // „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£Èñ¢Êï∞
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                runAllTests();
            }
        });
    </script>
</body>
</html>