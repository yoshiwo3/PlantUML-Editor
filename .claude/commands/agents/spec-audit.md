---
allowed-tools: Task, Read, Grep, Glob, WebFetch, TodoWrite, Edit, MultiEdit, Write, Bash
argument-hint: <relative path to specification document>
description: Audit implementation against specification using spec-implementation-auditor
---

# Specification Implementation Audit

設計書と実装の整合性を**spec-implementation-auditor**エージェントで詳細に監査し、レポートを自動保存します。

## 📋 監査対象
設計書パス: $ARGUMENTS

## 📁 レポート自動保存
- **保存先**: 監査対象ドキュメントと同じフォルダ
- **ファイル名**: `[元ファイル名（拡張子なし）]_audit_[YYYYMMDD_HHMM].md`
- **例**: `inline-editing-design-specification_audit_20250815_1430.md`
- **出力ファイル**: 監査レポート1ファイルのみ（中間ファイルは作成しない）

## 🎯 監査内容

このコマンドは以下の包括的な監査を実行します：

### 1. 実装状況の分析
- 設計書に記載された全機能の洗い出し
- 各機能の実装状況を確認
- コードベース全体をスキャンして対応箇所を特定

### 2. 詳細レポートの生成
- ✅ **実装済み機能リスト**
  - 完全に実装された機能
  - 対応するコードファイルとライン番号
  
- ❌ **未実装機能リスト**
  - まだ実装されていない機能
  - 優先度の提案
  
- ⚠️ **仕様と異なる実装**
  - 設計書と実装が一致しない箇所
  - 相違点の詳細説明
  
- 📊 **実装率（パーセンテージ）**
  - 全体の実装進捗率
  - カテゴリ別の実装率
  
- 🔧 **修正提案とコードサンプル**
  - 未実装機能の実装例
  - 不整合箇所の修正コード
  - ベストプラクティスの提案

## 🚀 実行手順

1. **設計書の読み込みと解析**
   - 指定された設計書を読み込み
   - 機能要件、非機能要件を抽出
   - 実装すべき項目のチェックリスト作成

2. **コードベースの包括的スキャン**
   - 関連するソースコードを検索
   - 実装パターンを分析
   - 設計書の要件との照合

3. **ギャップ分析**
   - 実装済み/未実装の判定
   - 仕様との相違点を検出
   - 改善提案の生成

4. **レポート生成**
   - 分かりやすい形式で結果を整理
   - 実装率の計算と可視化
   - アクション可能な提案を提供

## 📝 使用例

```bash
# PRDとの整合性チェック
/spec-audit PRD_完全統合版.md

# 特定機能の設計書をチェック
/spec-audit PlantUML_Editor_Proto/inline-editing-design-specification.md

# 相対パスで指定
/spec-audit ./docs/api-specification.md
```

## 🔄 エージェント実行と自動保存

Task toolを使用してspec-implementation-auditorエージェントを起動し、以下のタスクを実行します：

```
監査タスク: 
1. $ARGUMENTSで指定された設計書を読み込む
2. プロジェクト全体のコードをスキャン
3. 設計書の要件と実装を照合
4. 上記5つの形式でレポートを生成
5. 具体的な改善アクションを提案
6. 監査レポート1ファイルのみをMarkdown形式で保存
   - 中間ファイルは作成しない
   - ファイル名: [元ファイル名]_audit_[YYYYMMDD_HHMM].md
```

### 📝 レポート保存処理
1. 現在時刻を取得（YYYYMMDD_HHMM形式）
2. 元ファイル名から拡張子を除去
3. `[元ファイル名]_audit_[YYYYMMDD_HHMM].md`形式でファイル名生成
4. 設計書と同じディレクトリに監査レポートを保存
5. すべての詳細情報を含む完全なレポートを1ファイルに保存
6. 既存ファイルがある場合は上書き
7. 中間ファイルやテンポラリファイルは作成しない

設計書パスが相対パスで指定された場合は、プロジェクトルートからの相対パスとして解釈されます。

## 実行後の処理

監査完了後、以下のアクションを自動実行：
1. レポートファイルのパスを表示
2. 主要な発見事項のサマリーを画面に表示
3. 次のアクションの提案を提示