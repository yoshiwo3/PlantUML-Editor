# 日本語→PlantUML変換アプリ 企画書（完全版）

## 🎯 このアプリは何か？

**日本語で書くだけで、プロ品質の図が作れるツール**です。

PlantUMLの記法を覚える必要はありません。普段使っている日本語をそのまま入力すれば、自動的に図になります。

## 💡 なぜ必要なのか？

### よくある悩み
- 📊 **会議で図が必要だが、作り方がわからない**
- ⏰ **図を作る時間がない**（PowerPointは面倒）
- 🤔 **運用が決まってないのに、図を求められる**
- 👥 **チームで認識を合わせたいが、言葉だけでは伝わらない**

### このアプリが解決すること
✅ 日本語を書くだけで図が完成  
✅ 運用が未確定でも「？」「案A/案B」で表現可能  
✅ 10分あれば、会議資料が準備できる  

---

## 👤 誰のためのアプリか？

### 🎯 ペルソナ1: 田中 健太（35歳）- EC運用チームリーダー

#### プロフィール
- **役職**: SaaS販売ECサイト 運用企画部 チームリーダー
- **経験**: EC運用5年、前職は営業職3年
- **技術レベル**: Excel上級、SQL基礎、プログラミング経験なし
- **チーム**: 部下3名（全員非エンジニア）

#### 日常の課題
- 月2回の運用改善会議で、現状フローと改善案を説明する必要がある
- PowerPointで図を作るのに毎回3時間かかっている
- 開発チームに要件を伝える際、言葉だけでは正確に伝わらない
- 運用ルールが確定する前に、複数案を並行検討したい

#### このアプリで解決したいこと
```
「会議の30分前に、部長から『今の請求フローを図にして』と言われても対応できるようになりたい」
「A案とB案を並べて見せて、どちらがいいか議論したい」
```

#### 典型的な利用シーン
- **月曜朝**: 週次会議用に先週の課題フローを図解（15分）
- **火曜午後**: 新規決済手段導入の影響範囲を可視化（20分）
- **金曜夕方**: 来週の開発MTG用にマスタ関係を整理（30分）

---

### 🎯 ペルソナ2: 佐藤 美咲（28歳）- IT営業

#### プロフィール
- **役職**: SaaSベンダー セールスエンジニア
- **経験**: IT営業3年、情報系学部卒
- **技術レベル**: 技術用語は理解、コードは読めるが書けない
- **担当**: 大手企業向け提案活動

#### 日常の課題
- 顧客への提案時に、システム連携イメージを素早く作りたい
- 技術部門との打ち合わせで、顧客要件を正確に伝えたい
- RFP回答で、実装フローの説明図が必要
- 顧客ごとにカスタマイズした業務フローを作成する必要がある

#### このアプリで解決したいこと
```
「お客様の前で、その場で要件を図にしながら認識合わせがしたい」
「提案書の図を自分で作れるようになって、技術部門の負担を減らしたい」
```

#### 典型的な利用シーン
- **顧客訪問前**: 標準フローをベースに顧客用にカスタマイズ（20分）
- **商談中**: 顧客の要望をリアルタイムで図に反映（5分）
- **提案書作成**: システム構成図とデータフローを作成（30分）

---

### 🎯 ペルソナ3: 山田 太郎（42歳）- プロジェクトマネージャー

#### プロフィール
- **役職**: システム統合プロジェクト PM
- **経験**: PM歴10年、元SEで技術理解あり
- **技術レベル**: 10年前はコードを書いていたが、今は管理業務のみ
- **管理範囲**: 5部門、20名規模のプロジェクト

#### 日常の課題
- 部門間の業務フローが複雑で、全体像を把握しづらい
- ステークホルダーへの進捗報告で、視覚的な資料が必要
- 仕様変更の影響範囲を素早く可視化したい
- WBSとガントチャートの作成に時間がかかる

#### このアプリで解決したいこと
```
「部門横断の複雑なフローを、階層的に整理して見せたい」
「仕様変更があった時、影響箇所を即座に図で示したい」
```

#### 典型的な利用シーン
- **週次定例**: 進捗状況をガントチャートで報告（10分）
- **仕様変更時**: 影響範囲を活動図で可視化（15分）
- **月次報告**: 部門間連携フローを更新（25分）

---

### 📊 ペルソナ比較表

| 項目 | 田中（EC運用） | 佐藤（IT営業） | 山田（PM） |
|------|--------------|--------------|-----------|
| **図解経験** | ほぼなし | 少しあり | 経験豊富 |
| **作成頻度** | 週2-3回 | 週5-10回 | 毎日 |
| **主な図種** | シーケンス、活動図 | シーケンス、クラス図 | ガント、活動図 |
| **重視点** | 簡単さ、速さ | 見栄え、柔軟性 | 正確性、網羅性 |
| **利用時間帯** | 会議直前 | 商談中、提案書作成時 | 計画時、報告時 |
| **共有相手** | 社内（上司、開発） | 顧客、社内技術部 | 経営層、チーム |

### 📝 新機能のユースケース

#### 🎨 注釈機能の活用シーン

##### シーン1: 会議での図面レビュー
**状況**: 開発チームとの設計レビュー会議中  
**ユーザー**: 田中さん（EC運用チームリーダー）  
**活用方法**:
1. 生成したシーケンス図を画面共有
2. 赤ペンで問題箇所を直接マーキング
3. 矢印で「ここが不明確」と指摘
4. テキストで「要確認：与信チェックタイミング」と注記
5. 注釈付きPNGで議事録に添付

**効果**: 口頭説明だけでは伝わりにくい指摘が、視覚的に明確に

##### シーン2: 顧客向け提案の最終調整
**状況**: 商談前夜の提案資料最終チェック  
**ユーザー**: 佐藤さん（IT営業）  
**活用方法**:
1. システム連携図に顧客固有の修正点を注釈
2. 緑の矢印で「御社の既存システム」を明示
3. テキストで「Phase2で実装予定」等の補足
4. 注釈データを保存して翌朝に復元
5. 商談中にリアルタイムで追加注釈

**効果**: 標準図から顧客専用図へのカスタマイズが容易

##### シーン3: プロジェクト進捗報告
**状況**: ステークホルダー向け月次報告  
**ユーザー**: 山田さん（プロジェクトマネージャー）  
**活用方法**:
1. ガントチャートに進捗状況を色分けで注釈
2. 遅延タスクに赤丸で「リスク」とマーク
3. 完了タスクに青チェックマーク追加
4. 依存関係の変更を矢印で図示
5. 注釈付き画像をレポートに統合

**効果**: 数値だけでは伝わらない進捗状況が一目で理解可能

#### 📷 画像解析機能の活用シーン

##### シーン1: 紙の業務フロー図のデジタル化
**状況**: 古い業務マニュアルのデジタル化プロジェクト  
**ユーザー**: 田中さん（EC運用チームリーダー）  
**活用方法**:
1. 紙のフローチャートをスマホで撮影
2. アプリにアップロードしてOCR処理実行
3. 認識されたテキストを確認・修正
4. 自動生成されたPlantUMLコードを調整
5. 最新システムに合わせて内容更新

**効果**: 手作業でのタイピングが不要、作業時間が1/3に短縮

##### シーン2: ホワイトボードの議事録化
**状況**: 設計会議後のホワイトボード内容の記録  
**ユーザー**: 佐藤さん（IT営業）  
**活用方法**:
1. 会議終了時にホワイトボードを撮影
2. 画像解析で手書き文字とフロー構造を認識
3. 抽出されたテキストから要素を整理
4. PlantUMLコードを自動生成
5. 参加者に議事録として共有

**効果**: 手書きメモの転記作業が自動化、議事録作成時間が大幅短縮

##### シーン3: 競合他社資料の分析
**状況**: 競合分析のための公開資料調査  
**ユーザー**: 山田さん（プロジェクトマネージャー）  
**活用方法**:
1. 競合のWebサイトや公開資料から図表を取得
2. 画像解析でシステム構成図を解読
3. 自社システムとの比較用図表を生成
4. 差分分析結果を社内共有
5. 自社改善点の検討材料として活用

**効果**: 競合情報の構造化と比較分析が効率化

#### 🔄 draw.io連携機能の活用シーン

##### シーン1: 提案書の高品質化
**状況**: 大口顧客向けシステム提案書作成  
**ユーザー**: 佐藤さん（IT営業）  
**活用方法**:
1. 日本語でシステム概要を記述
2. PlantUMLで基本的な構成図を生成
3. draw.io形式でエクスポート
4. draw.ioで顧客ロゴ・企業カラーを適用
5. PowerPoint等に統合して提案書完成

**効果**: 技術的正確性と視覚的魅力を両立した提案資料

##### シーン2: チーム協業での設計書作成
**状況**: 複数部門が関わるシステム設計  
**ユーザー**: 山田さん（プロジェクトマネージャー）  
**活用方法**:
1. 各部門の要求を日本語で整理
2. PlantUMLで全体アーキテクチャを生成
3. draw.io形式で各部門に配布
4. 部門ごとにdraw.ioで詳細化・調整
5. 最終的に統合して設計書完成

**効果**: 部門間の並行作業が可能、設計書作成期間が短縮

##### シーン3: 既存資産の活用と更新
**状況**: 既存のdraw.io図面の更新・保守  
**ユーザー**: 田中さん（EC運用チームリーダー）  
**活用方法**:
1. 業務変更内容を日本語で記述
2. PlantUMLで変更後のフローを生成
3. 既存のdraw.ioファイルと比較
4. 差分をdraw.ioで手動調整
5. 更新履歴と共に文書管理システムに保存

**効果**: 既存資産を活かしつつ効率的な更新が可能

### 🎭 アンチペルソナ（対象外ユーザー）

#### ❌ 対象外1: プロのエンジニア
- PlantUMLを直接書ける
- IDEでコード生成できる
- より高度なツールを使いこなせる

#### ❌ 対象外2: 完全な非IT職
- システムの概念が理解できない
- 図解の必要性を感じない
- Excelで十分と考えている

#### ❌ 対象外3: デザイナー
- 美しいビジュアルを求める
- Adobe製品で作成する
- 厳密なデザインルールがある

---

## ✨ 3つの特徴

### 1️⃣ **日本語だけでOK**
```text
顧客がECに見積依頼を送る
ECが顧客に見積結果を通知
```
↓ これだけで美しいシーケンス図に！

### 2️⃣ **運用が未確定でもOK**
```text
ECが与信チェック？     ← 点線で表示
案A: 自動承認で進む    ← 青レーン
案B: 営業確認が必要    ← 緑レーン
```

### 3️⃣ **階層的に詳細化できる**
- **レベル1**: 見積→注文→契約→請求（全体像）
- **レベル2**: 見積業務の10ステップ（業務詳細）
- **レベル3**: 価格計算の5ステップ（作業手順）

---

## 📝 書き方は「1行の型」を覚えるだけ

### 4つの基本パターン

| 図の種類 | 書き方 | 例 |
|----------|--------|-----|
| **業務フロー** | AがBに○○する | 顧客がECに見積を送る |
| **作業手順** | ○○を実行 | 見積条件を確認 |
| **データ関係** | AはBを保持 | CustomerはOrderを保持 |
| **スケジュール** | [部門] タスク 期間 | [営業] 提案準備 1/10〜1/15 |

### 条件分岐も簡単
```text
条件: 承認 -> 次へ進む / 却下 -> 差し戻し
```

---

## 🚀 10分で使い始められる

### ステップ1: テンプレートを選ぶ（1分）
<table>
<tr>
<td width="33%">

**📊 見積→請求フロー**  
ECサイトの基本的な  
商流を可視化

</td>
<td width="33%">

**💳 NP掛け払い**  
与信〜入金消込まで  
の流れを整理

</td>
<td width="33%">

**🗂️ マスタER**  
顧客・注文・請求の  
データ関係を表現

</td>
</tr>
</table>

### ステップ2: カスタマイズ（5分）
テンプレートの文章を自社用に書き換えるだけ

### ステップ3: 共有（1分）
- **PNG/SVG**でダウンロード
- **draw.io**で開いて編集
- **URL**をチャットに貼る
- **PlantUMLコード**をコピー

---

## 🎨 画面構成

```
┌─────────────┬─────────────────────────────────┐
│ サイドメニュー │         メインエリア              │
├─────────────┼─────────────────────────────────┤
│ 📝 作成      │ [入力]     [図種候補]   [プレビュー] │
│ 📚 テンプレ   │  日本語     自動判定      リアルタイム │
│ 🎓 学習      │  テキスト    表示         SVG表示    │
│ 📜 履歴      │                                    │
│ ⚙️ 設定      │ [出力オプション]                    │
│             │  PNG・SVG・コード・URL              │
└─────────────┴─────────────────────────────────┘
```

---

## 📋 機能要件

### 1. コア機能（必須）

#### 1.1 入力・変換
| 機能 | 説明 | 詳細 |
|------|------|------|
| **日本語パーサー** | 自然な日本語を解析 | 形態素解析で主語・述語・目的語を抽出 |
| **図種自動判定** | 最適な図を推定 | 入力内容から確信度付きで判定 |
| **曖昧性解決** | 不明確な要素を検出 | 「誰が不明です」等の具体的な指摘 |

#### 1.2 未確定要素の処理
| 機能 | 説明 | 視覚表現 |
|------|------|----------|
| **疑問符認識** | 「？」付き要素 | 点線で表示 |
| **A/B案管理** | 複数案の並行検討 | 色分けレーンで表示 |
| **仮要素** | 「仮」「未定」の扱い | 黄色背景で強調 |
| **削除予定** | 廃止予定の要素 | グレーアウト表示 |

#### 1.3 階層管理
| 機能 | 説明 | 操作 |
|------|------|------|
| **3階層詳細度** | L1全体→L2業務→L3タスク | タブで切替 |
| **ドリルダウン** | 下位階層への遷移 | クリックで詳細へ |
| **ブレッドクラム** | 現在位置の表示 | 階層パスを表示 |

### 2. UI/UX機能

#### 2.1 エディタ
| 機能 | 説明 | 効果 |
|------|------|------|
| **構文ハイライト** | 要素を色分け | 誰が・誰に・何をが一目瞭然 |
| **リアルタイムヒント** | 書き方をガイド | 入力中に吹き出しで支援 |
| **自動補完** | よく使う表現を予測 | 入力速度向上 |
| **エラー箇所表示** | 問題のある行を強調 | 赤下線で即座に認識 |

#### 2.2 プレビュー
| 機能 | 説明 | 性能目標 |
|------|------|----------|
| **自動更新** | リアルタイム反映 | 0.3秒以内 |
| **ズーム/パン** | 拡大縮小・移動 | マウス操作対応 |
| **要素ハイライト** | 対応箇所の強調 | 双方向の関連表示 |

### 3. 初心者サポート

#### 3.1 オンボーディング
| 機能 | 説明 | タイミング |
|------|------|------------|
| **ウェルカムフロー** | 目的選択画面 | 初回起動時 |
| **ガイド付き入力** | 最初の3行を指導 | 入力開始時 |
| **成功体験演出** | 完成メッセージ | 初回図生成時 |

#### 3.2 エラー支援
| 機能 | 説明 | 表示例 |
|------|------|--------|
| **修正候補提示** | 3つの選択肢 | クリックで自動修正 |
| **理由説明** | 平易な言葉で説明 | 「送る相手が不明です」 |
| **類似例表示** | 正しい書き方 | 「例: 顧客がECに〜」 |

### 4. データ管理

| 機能 | 説明 | 保存先 |
|------|------|--------|
| **自動保存** | 入力内容を自動保存 | LocalStorage |
| **履歴管理** | 直近30件を保存 | LocalStorage |
| **設定管理** | 同義語辞書等 | LocalStorage |

### 5. 出力・共有

| 機能 | 説明 | 形式 |
|------|------|------|
| **画像出力** | 図を画像として保存 | PNG/SVG/PDF |
| **コード出力** | PlantUMLコード取得 | テキスト |
| **draw.io連携** | PlantUML経由でdraw.io形式に変換・編集可能 | mxGraph XML |
| **パーマリンク** | URLで共有 | 圧縮データ埋め込み |
| **SNS連携** | Slack/Teams投稿 | ワンクリック |

### 6. 注釈機能（Canvas API）

#### 6.1 描画ツール
| ツール | 機能 | 操作方法 |
|--------|------|----------|
| **ペンツール** | 自由な手書き線の描画 | マウス/タッチドラッグで描画 |
| **矢印ツール** | 注意点を指し示す矢印描画 | 始点から終点をドラッグで描画 |
| **テキストツール** | テキストコメントの追加 | クリック位置に入力フィールド表示 |
| **消しゴムツール** | 注釈の部分削除 | 対象要素の近くをクリック/ドラッグ |

#### 6.2 スタイル設定
| 設定項目 | 説明 | 初期値 |
|----------|------|--------|
| **線の色** | ペン・矢印・テキストの色 | 赤 (#ff0000) |
| **線の太さ** | ペン・矢印の線幅 | 3px |
| **フォントサイズ** | テキストのサイズ | 16px |
| **フォントファミリー** | テキストのフォント | sans-serif |

#### 6.3 描画レイヤー管理
| 機能 | 説明 | 技術実装 |
|------|------|----------|
| **レイヤー重ね合わせ** | SVG図の上にCanvas描画レイヤーを配置 | position: absolute, z-index: 10 |
| **自動リサイズ** | SVG図のサイズ変更に追従 | ResizeObserver/window.resize対応 |
| **座標同期** | SVG要素とCanvas座標の正確な対応 | getBoundingClientRect()で位置調整 |
| **高DPI対応** | Retina等高解像度ディスプレイ対応 | devicePixelRatio考慮 |

#### 6.4 注釈データ管理
| 機能 | 説明 | データ形式 |
|------|------|----------|
| **データ永続化** | 注釈内容をJSON形式で保存 | LocalStorage/SessionStorage |
| **保存/読込** | ファイルとして注釈データを出力/入力 | JSON形式 |
| **元に戻す機能** | 直近の注釈操作を取り消し | 注釈配列のpop操作 |
| **全消去機能** | 全ての注釈を削除 | 注釈配列の初期化 |

#### 6.5 エクスポート機能
| 機能 | 説明 | 出力形式 |
|------|------|----------|
| **注釈付き画像出力** | SVG + 注釈を統合した画像生成 | PNG形式 |
| **注釈データ出力** | 注釈のみを別ファイルとして保存 | JSON形式 |
| **印刷対応** | 注釈付きで印刷可能な形式 | SVG/PDF形式 |

### 7. 画像解析機能（OCR + パターン認識）

#### 7.1 OCR（光学文字認識）
| 機能 | 説明 | 技術仕様 |
|------|------|----------|
| **多言語対応** | 日本語・英語の文字認識 | Tesseract.js (jpn+eng) |
| **テキスト抽出** | 画像内のテキストを文字列として取得 | 信頼度付きで返却 |
| **座標情報付き抽出** | 各テキストの位置情報も取得 | 座標とバウンディングボックス |
| **前処理最適化** | コントラスト調整・ノイズ除去 | Canvas APIで画像前処理 |

#### 7.2 パターン認識・図種判定
| パターン | 検出内容 | 判定ロジック |
|----------|----------|------------|
| **矩形パターン** | ボックス・ノードの検出 | エッジ検出で四角形を識別 |
| **矢印パターン** | 接続線・フローの検出 | 直線 + 三角形の組み合わせ |
| **ライフライン** | シーケンス図の縦線 | 長い縦線の検出 |
| **時系列軸** | ガント図・スケジュール | 水平線 + 日付パターン |
| **状態図パターン** | 楕円・遷移線 | 曲線形状の検出 |
| **アクター** | 人型・ユースケース図 | 棒人間パターン |

#### 7.3 自動PlantUMLコード生成
| 図種 | 生成ルール | 出力例 |
|------|------------|--------|
| **シーケンス図** | アクター + 矢印パターン | participant/actor + メッセージ線 |
| **アクティビティ図** | ボックス + フロー | start → activity → stop |
| **ガントチャート** | 日付 + タスクリスト | プロジェクト期間 + タスク依存関係 |
| **クラス図** | エンティティ + 関連線 | class定義 + association |
| **状態遷移図** | 状態 + 遷移 | state + transition |
| **ユースケース図** | アクター + ユースケース | actor + usecase + association |

#### 7.4 画像アップロード機能
| 機能 | 説明 | 対応形式 |
|------|------|----------|
| **ファイル選択** | ローカルファイルからの画像選択 | JPG, PNG, GIF, BMP |
| **ドラッグ&ドロップ** | 画像ファイルを直接ドロップ | 全対応形式 |
| **ペースト機能** | クリップボードから画像貼り付け | 画像データ形式 |
| **カメラ撮影** | スマートフォンでの直接撮影 | モバイル対応 |

#### 7.5 解析結果の検証・修正
| 機能 | 説明 | ユーザー操作 |
|------|------|------------|
| **認識テキスト表示** | OCRで抽出されたテキストを表示 | 編集可能なテキストエリア |
| **図種選択** | 自動判定結果の手動変更 | ドロップダウンで選択 |
| **要素編集** | 認識された要素の追加・削除・修正 | インタラクティブな編集UI |
| **プレビュー機能** | 生成されたPlantUMLの即座確認 | リアルタイムレンダリング |

---

## 📊 パフォーマンス要件

| 項目 | 目標値 | 重要度 |
|------|--------|--------|
| **初回表示** | 1.5秒以内 | 必須 |
| **プレビュー更新** | 0.3秒以内 | 必須 |
| **図種判定** | 0.1秒以内 | 必須 |
| **画像生成** | 2秒以内 | 高 |

---

## 🎯 品質目標

| 指標 | 目標値 | 測定方法 |
|------|--------|----------|
| **初回成功率** | 90%以上 | 初めて使う人が図を作れる割合 |
| **図種判定精度** | 80%以上 | 第一候補の正解率 |
| **エラー回復率** | 70%以上 | ヒントで自己解決できる割合 |
| **作成時間** | 10分以内 | テンプレから完成まで |

---

## 🧪 テスト計画

### 注釈機能のテスト仕様

#### 機能テスト
| テストケース | 入力 | 期待値 | 重要度 |
|-------------|------|--------|--------|
| **ペンツール基本描画** | マウスドラッグで曲線描画 | 滑らかな曲線がCanvas上に描画される | 高 |
| **矢印ツール描画** | 始点から終点までドラッグ | 矢印が正確な位置に描画される | 高 |
| **テキストツール入力** | クリック位置にテキスト入力 | 指定位置にテキストが表示される | 高 |
| **消しゴムツール** | 描画済み要素の近くをクリック | 対象要素が削除される | 中 |
| **色変更** | カラーピッカーで色選択 | 新しい描画要素が選択色で描画 | 中 |
| **線幅変更** | スライダーで線幅調整 | 新しい描画要素が指定幅で描画 | 中 |
| **元に戻す** | Undoボタンクリック | 最後の描画操作が取り消される | 中 |
| **全消去** | Clearボタンクリック | 全ての注釈が削除される | 低 |

#### パフォーマンステスト
| テストケース | 条件 | 期待値 | 計測方法 |
|-------------|------|--------|----------|
| **描画レスポンス** | 連続的なマウス移動 | 16ms以内の応答 | Performance.now() |
| **大量注釈処理** | 1000個の注釈要素 | 60fps維持 | DevTools Performance |
| **メモリ使用量** | 10分間の連続使用 | 50MB以下 | Performance.memory |
| **Canvas大サイズ** | 4K解像度の図 | 正常動作 | 実機テスト |

#### 互換性テスト
| 環境 | テスト内容 | 期待値 |
|------|------------|--------|
| **Chrome/Edge** | 全機能動作確認 | 100%動作 |
| **Firefox** | 全機能動作確認 | 100%動作 |
| **Safari** | 全機能動作確認 | 95%動作（Web Worker制限考慮）|
| **タブレット** | タッチ操作確認 | 基本機能動作 |
| **モバイル** | 表示確認のみ | 閲覧可能 |

### 画像解析機能のテスト仕様

#### 機能テスト
| テストケース | 入力画像 | 期待値 | 重要度 |
|-------------|----------|--------|--------|
| **日本語OCR基本** | 日本語テキストのみの画像 | 90%以上の文字認識精度 | 高 |
| **英語OCR基本** | 英語テキストのみの画像 | 95%以上の文字認識精度 | 高 |
| **混在文字認識** | 日英混在テキスト画像 | 85%以上の文字認識精度 | 高 |
| **手書き文字認識** | ホワイトボードの手書き文字 | 70%以上の文字認識精度 | 中 |
| **図種自動判定** | 各種図表の画像 | 80%以上の図種判定精度 | 高 |
| **シーケンス図生成** | アクター+メッセージ構造 | 妥当なPlantUMLコード生成 | 高 |
| **フローチャート生成** | ボックス+矢印構造 | 妥当なアクティビティ図コード | 高 |
| **不正画像処理** | 破損・不正形式ファイル | エラーハンドリング実行 | 中 |

#### パフォーマンステスト
| テストケース | 条件 | 期待値 | 計測方法 |
|-------------|------|--------|----------|
| **OCR処理時間** | A4サイズ画像（2MB） | 10秒以内 | Web Worker内計測 |
| **大サイズ画像** | 10MB制限ギリギリ | 30秒以内またはエラー | タイムアウト設定 |
| **並列処理制限** | 同時複数画像解析 | キュー管理で順次処理 | 同時実行数確認 |
| **メモリ管理** | 解析完了後 | リソース解放確認 | Performance.memory |

#### 精度テスト
| 画像タイプ | サンプル数 | 目標精度 | 測定項目 |
|-----------|----------|----------|----------|
| **印刷文書** | 100サンプル | 95% | 文字認識率 |
| **スクリーンショット** | 50サンプル | 90% | 文字認識率 |
| **手書きメモ** | 50サンプル | 70% | 文字認識率 |
| **図表混在** | 30サンプル | 85% | 構造認識率 |

### draw.io連携機能のテスト仕様

#### 機能テスト
| テストケース | 入力 | 期待値 | 重要度 |
|-------------|------|--------|--------|
| **シーケンス図変換** | 標準的なPlantUMLシーケンス図 | 有効なdraw.io XML生成 | 高 |
| **アクティビティ図変換** | 条件分岐含むアクティビティ図 | 菱形・矩形の適切な配置 | 高 |
| **クラス図変換** | メソッド・属性含むクラス図 | UMLクラス形状での変換 | 高 |
| **複雑図変換** | 100要素以上の大規模図 | 要素の重複・欠損なし | 中 |
| **XML妥当性** | 生成されたXML | mxGraphスキーマ準拠 | 高 |
| **draw.io読込** | 生成XMLをdraw.ioで開く | エラーなく表示 | 高 |
| **スタイル保持** | 色・線幅指定の図 | スタイル情報の保持 | 中 |
| **座標精度** | グリッドスナップ設定 | 10px単位での配置 | 中 |

#### パフォーマンステスト
| テストケース | 条件 | 期待値 | 計測方法 |
|-------------|------|--------|----------|
| **小規模変換** | 10要素以下 | 100ms以内 | タイムスタンプ比較 |
| **中規模変換** | 50要素程度 | 500ms以内 | タイムスタンプ比較 |
| **大規模変換** | 100要素以上 | 1秒以内 | タイムスタンプ比較 |
| **メモリ使用量** | 変換処理中 | 100MB以下 | Performance.memory |

#### 品質テスト
| テスト観点 | 検証内容 | 合格基準 |
|-----------|----------|----------|
| **構造保持** | PlantUMLとdraw.ioの構造比較 | 要素数・接続数が一致 |
| **意味保持** | 図の意味的整合性 | 人手レビューで95%合格 |
| **視覚品質** | 配置・見た目の妥当性 | ユーザビリティテスト80%満足 |
| **相互変換** | draw.io → PlantUML → draw.io | 情報の劣化なし（実験的） |

### 統合テスト

#### シナリオテスト
| シナリオ | 手順 | 期待結果 |
|----------|------|----------|
| **注釈→エクスポート** | 図生成→注釈追加→PNG出力 | 注釈付き画像の正常出力 |
| **画像解析→修正→出力** | 画像アップ→OCR→手動修正→図生成 | 修正内容が反映された図 |
| **日本語→draw.io→編集** | 日本語入力→PlantUML生成→draw.io変換→外部編集 | 編集可能なファイル生成 |
| **全機能連携** | 画像解析→PlantUML修正→注釈追加→draw.io出力 | 全ての機能が連携動作 |

#### 負荷テスト
| テスト項目 | 負荷条件 | 期待動作 |
|-----------|----------|----------|
| **同時ユーザー** | 50ユーザー同時アクセス | レスポンス劣化なし |
| **大量データ処理** | 10MB画像×10ファイル | キュー管理で順次処理 |
| **長時間使用** | 8時間連続使用 | メモリリーク発生なし |
| **リソース枯渇** | メモリ・CPU制限環境 | 適切なエラーハンドリング |

### テスト自動化

#### 自動テストスイート
```javascript
// 注釈機能の自動テスト例
describe('Annotation Tool', () => {
  test('ペンツールで線が描画される', async () => {
    const canvas = document.createElement('canvas');
    const tool = new AnnotationTool(canvas);
    
    tool.setTool('pen');
    tool.startDrawing(10, 10);
    tool.draw(20, 20);
    tool.endDrawing(30, 30);
    
    expect(tool.annotations.length).toBe(1);
    expect(tool.annotations[0].type).toBe('pen');
  });
});
```

#### CI/CDパイプライン
| ステージ | テスト内容 | 実行時間目標 |
|----------|------------|------------|
| **Unit Test** | 個別機能の単体テスト | 5分以内 |
| **Integration Test** | 機能間連携テスト | 10分以内 |
| **E2E Test** | ブラウザ自動テスト | 15分以内 |
| **Performance Test** | パフォーマンス回帰テスト | 20分以内 |

---

## 🛠️ 技術仕様

### 基本アーキテクチャ
- **フロントエンド**: Vanilla JavaScript (SPA)
- **バックエンド**: Node.js + Express
- **スタイリング**: CSS3 + フレックスボックス
- **エディタ**: テキストエリア + 構文ハイライト
- **図生成**: Kroki API
- **データ保存**: LocalStorage
- **コンテナ**: Docker + Docker Compose

### 注釈機能の技術仕様

#### Canvas API実装
| 技術要素 | 実装詳細 | パフォーマンス要件 |
|----------|----------|------------------|
| **Canvas要素** | HTML5 Canvas + 2D Context | 60fps描画対応 |
| **イベント処理** | Mouse/Touch Event Handling | <16ms レスポンス |
| **描画最適化** | RequestAnimationFrame使用 | メモリ使用量<50MB |
| **座標変換** | getBoundingClientRect()で精密位置取得 | ±1px精度 |

#### データ構造
```javascript
// 注釈データ形式
const annotationData = {
  type: 'pen|arrow|text|eraser',
  id: 'unique-identifier',
  timestamp: Date.now(),
  properties: {
    // ペンツールの場合
    points: [{x: number, y: number}, ...],
    color: '#ff0000',
    width: 3,
    
    // 矢印ツールの場合
    startX: number, startY: number,
    endX: number, endY: number,
    
    // テキストツールの場合
    text: 'string',
    x: number, y: number,
    fontSize: 16,
    fontFamily: 'sans-serif'
  }
};
```

#### レスポンシブ対応
| 画面サイズ | Canvas調整 | UI配置 |
|-----------|-----------|--------|
| **デスクトップ** | SVGサイズに完全同期 | 右側にツールパレット |
| **タブレット** | タッチイベント最適化 | 下部にツールバー |
| **モバイル** | スクロール対応 | フローティングツール |

### 画像解析機能の技術仕様

#### OCRエンジン（Tesseract.js）
| 設定項目 | 値 | 理由 |
|----------|---|------|
| **言語パック** | jpn+eng | 日本語・英語混在文書対応 |
| **認識精度** | PSM 6 | 単一のブロックテキスト想定 |
| **エンジンモード** | LSTM + Legacy | 精度と速度のバランス |
| **ワーカー設定** | Web Worker使用 | UIブロッキング防止 |

#### 画像前処理パイプライン
```javascript
// 画像前処理の流れ
const preprocessPipeline = [
  grayscaleConversion,     // グレースケール変換
  contrastEnhancement,     // コントラスト強化
  noiseReduction,         // ノイズ除去
  binarization,           // 二値化
  skewCorrection          // 傾き補正
];
```

#### パターン認識アルゴリズム
| パターン | 検出方法 | 実装技術 |
|----------|----------|----------|
| **エッジ検出** | Canny Edge Detection | Canvas ImageData処理 |
| **直線検出** | Hough Transform簡易版 | 座標統計処理 |
| **形状認識** | 輪郭抽出 + 近似 | ポリゴン近似 |
| **テキスト領域** | Connected Components | ピクセル連結成分解析 |

#### メモリ・パフォーマンス管理
| リソース | 制限値 | 管理方法 |
|----------|--------|----------|
| **画像サイズ** | 最大10MB | ファイルサイズチェック |
| **Canvas解像度** | 最大4096x4096 | 動的リサイズ |
| **OCRワーカー** | 同時実行1つ | キュー管理 |
| **メモリ使用量** | 最大200MB | 処理完了時にクリーンアップ |

### draw.io連携機能の技術仕様

#### XML生成エンジン
| コンポーネント | 技術仕様 | パフォーマンス |
|---------------|----------|----------------|
| **PlantUMLパーサー** | 正規表現 + 構文解析 | <100ms (1000行以内) |
| **XML生成器** | DOM操作 + シリアライズ | <50ms |
| **スタイル適用** | CSS-like属性マッピング | <20ms |
| **座標計算** | 自動レイアウトアルゴリズム | <200ms |

#### XML構造仕様
```xml
<!-- 生成されるmxGraph XML構造 -->
<mxfile host="app.diagrams.net">
  <diagram id="diagram-id">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        
        <!-- 図要素 -->
        <mxCell id="element-id" value="Text" 
                style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1"
                vertex="1" parent="1">
          <mxGeometry x="160" y="80" width="120" height="60" as="geometry"/>
        </mxCell>
        
        <!-- 接続線 -->
        <mxCell id="edge-id" value="Label" 
                style="endArrow=block;html=1;rounded=0"
                edge="1" parent="1" source="source-id" target="target-id">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
```

#### 図種別変換ルール
| PlantUML図種 | 変換戦略 | 特殊処理 |
|-------------|----------|----------|
| **シーケンス図** | ライフライン + メッセージ | アクター位置の自動調整 |
| **アクティビティ図** | フローチャート要素 | 条件分岐の菱形化 |
| **クラス図** | UMLクラス形状 | 継承関係の階層化 |
| **状態遷移図** | 状態ノード + 遷移 | 開始/終了状態の特別扱い |

### パフォーマンス要件（技術詳細）

#### レスポンス時間目標
| 機能 | 目標値 | 測定方法 | 最適化手法 |
|------|--------|----------|-----------|
| **注釈描画** | <16ms/frame | Performance.now() | RequestAnimationFrame |
| **OCR処理** | <10秒 (A4画像) | Web Worker内計測 | 画像圧縮 + 並列処理 |
| **draw.io変換** | <1秒 | 変換前後タイムスタンプ | DOM最適化 + キャッシュ |
| **PlantUML描画** | <300ms | Kroki API応答時間 | 画像キャッシュ |

#### メモリ使用量制限
| コンポーネント | 制限値 | 監視方法 |
|---------------|--------|----------|
| **Canvas要素** | 最大100MB | Canvas.measureSize() |
| **OCR処理** | 最大200MB | Performance.memory |
| **画像キャッシュ** | 最大50MB | Cache API |
| **注釈データ** | 最大10MB | JSON.stringify().length |

### 対応環境（詳細）
| 環境 | 対応レベル | 制約事項 |
|------|------------|----------|
| **Chrome 90+** | 完全対応 | - |
| **Edge 90+** | 完全対応 | - |
| **Firefox 88+** | 完全対応 | OCRパフォーマンス若干低下 |
| **Safari 14+** | 部分対応 | Web Worker制限あり |
| **タブレット** | 基本機能のみ | 注釈機能簡易版 |
| **スマートフォン** | 閲覧のみ | 編集機能無効 |

### セキュリティ技術仕様

#### データ処理方針
| データ種別 | 処理場所 | セキュリティ対策 |
|------------|----------|----------------|
| **入力テキスト** | ブラウザローカル | XSSサニタイゼーション |
| **画像データ** | ブラウザ + OCRワーカー | ファイル形式検証 |
| **注釈データ** | ブラウザローカル | JSON検証 |
| **PlantUMLコード** | Kroki API送信 | HTTPS必須 |

#### 実装セキュリティ
```javascript
// セキュリティ対策の実装例
const sanitizeInput = (input) => {
  return input
    .replace(/[<>]/g, '') // HTMLタグ除去
    .replace(/javascript:/gi, '') // JavaScript URL除去
    .trim();
};

const validateImageFile = (file) => {
  const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];
  const maxSize = 10 * 1024 * 1024; // 10MB
  
  return allowedTypes.includes(file.type) && file.size <= maxSize;
};
```

---

## 📈 開発ロードマップ

### 🏃 **Phase 1: MVP**（2週間）
#### 必須機能
- ✅ 日本語→PlantUML変換エンジン
- ✅ 3つのECテンプレート
- ✅ リアルタイムプレビュー
- ✅ 基本的なエラー支援

#### 成果物
- 動作するWebアプリ
- 基本的な変換が可能
- テンプレートから10分で図作成

### 🚶 **Phase 2: 運用策定対応**（2週間）
#### 追加機能
- ⬜ 未確定要素の視覚化（？、仮、案A/B）
- ⬜ 階層管理（3階層の詳細度）
- ⬜ 履歴保存・復元
- ⬜ 同義語辞書
- ⬜ draw.io XML出力（PlantUML経由）

#### 成果物
- 運用が固まっていない段階でも使える
- 複雑な業務の詳細まで表現可能
- draw.ioでの再編集が可能

### 🧑‍🎓 **Phase 3: 初心者対応**（2週間）
#### 追加機能
- ⬜ ウェルカムフロー
- ⬜ インタラクティブチュートリアル
- ⬜ 高度なエラー支援
- ⬜ 学習ページ

#### 成果物
- 図解未経験者の90%が成功
- 10分で基本操作マスター

### 🚀 **Phase 4: 拡張機能**（2週間）
#### 追加機能
- ⬜ 全図種対応（ER図、ユースケース図等）
- ⬜ チーム共有機能
- ⬜ PWA対応
- ⬜ プラグイン機能

#### 成果物
- エンタープライズ対応
- オフライン動作可能

---

## 🔄 draw.io連携機能（PlantUML経由）

### 変換フロー
```
日本語テキスト
    ↓ ① 既存機能
PlantUMLコード生成
    ↓ ② 新規追加
draw.io XML変換
    ↓ ③ 出力
draw.ioで編集可能なファイル
```

### 8.1 PlantUML → draw.io XML 変換仕様

#### 対応する変換パターン
| PlantUML要素 | draw.io要素 | 変換ルール | 実装詳細 |
|-------------|------------|-----------|----------|
| participant | UMLアクター/矩形 | 人物はアクター、システムは矩形 | shape=umlActor/rectangle |
| -> | メッセージ線 | endArrow=block | edgeStyle=orthogonalEdgeStyle |
| note | 注釈 | shape=note | fillColor=lightyellow |
| class | UMLクラス | swimlane形式 | shape=umlClass |
| activity | フローチャート | rounded=1の矩形 | shape=process |
| state | 状態ノード | 楕円形状 | shape=ellipse |
| usecase | ユースケース | 楕円形状 | shape=ellipse |
| actor | アクター | 人型アクター | shape=umlActor |

#### 詳細な変換ルール

##### シーケンス図変換
| PlantUML構文 | draw.io XML | スタイル設定 |
|-------------|-------------|-------------|
| participant A | `<mxCell id="A" value="A" style="shape=umlActor"/>` | width="30" height="60" |
| A -> B: message | メッセージライン | endArrow=block;strokeColor=black |
| activate A | ライフライン強調 | strokeWidth=3;fillColor=lightgray |
| note right: text | 注釈ボックス | shape=note;whiteSpace=wrap |

##### アクティビティ図変換
| PlantUML構文 | draw.io XML | スタイル設定 |
|-------------|-------------|-------------|
| start | 開始ノード | shape=ellipse;fillColor=black |
| :activity; | アクティビティ | shape=process;rounded=1 |
| if (condition) | 条件分岐 | shape=rhombus;fillColor=yellow |
| stop | 終了ノード | shape=ellipse;fillColor=black |

##### クラス図変換
| PlantUML構文 | draw.io XML | スタイル設定 |
|-------------|-------------|-------------|
| class ClassName | クラスボックス | shape=swimlane;fontStyle=1 |
| +method() | パブリックメソッド | fontColor=green;fontSize=11 |
| -field | プライベートフィールド | fontColor=red;fontSize=11 |
| A -- B | 関連線 | endArrow=none;strokeColor=black |

### 8.2 最適化機能

#### レイアウト最適化
| 機能 | 説明 | 設定値 |
|------|------|--------|
| **グリッドスナップ** | 全座標を10の倍数に調整 | gridSize="10" snap="1" |
| **接続ポイント固定** | 要素間の接続を正確に | snapToPoint="1" |
| **自動レイアウト** | 適切な間隔で配置 | 水平150pt、垂直80pt |
| **重複回避** | 要素の重なりを防止 | collision detection |

#### スタイル統一
| 要素タイプ | フォント | カラーパレット | 線スタイル |
|-----------|--------|-------------|----------|
| **テキスト** | Helvetica 12pt | #000000 | - |
| **ボックス** | Helvetica 11pt | #FFFFFF背景, #000000枠 | strokeWidth=1 |
| **矢印** | - | #000000 | strokeWidth=1 |
| **注釈** | Helvetica 10pt | #FFFACD背景 | dashed |

### 8.3 実装アーキテクチャ

#### 変換エンジン
```javascript
// PlantUMLパーサークラス
class PlantUMLParser {
  parse(pumlCode) {
    // PlantUMLコードを構造化データに変換
    return {
      type: 'sequence|activity|class|state|usecase',
      elements: [...],
      connections: [...],
      styles: {...}
    };
  }
}

// draw.io変換クラス
class DrawIOConverter {
  constructor() {
    this.gridSize = 10;
    this.snapToPoint = true;
    this.autoLayout = true;
  }
  
  convert(parsedData) {
    const mxGraphModel = this.createMxGraphModel();
    
    // 要素の配置とスタイリング
    parsedData.elements.forEach(element => {
      const cell = this.createElement(element);
      mxGraphModel.appendChild(cell);
    });
    
    // 接続線の作成
    parsedData.connections.forEach(conn => {
      const edge = this.createEdge(conn);
      mxGraphModel.appendChild(edge);
    });
    
    return this.generateXML(mxGraphModel);
  }
}
```

#### XML生成機能
```javascript
// draw.io形式のXML生成
generateXML(mxGraphModel) {
  const xmlDoc = `
    <mxfile host="app.diagrams.net">
      <diagram>
        <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10">
          <root>
            <mxCell id="0"/>
            <mxCell id="1" parent="0"/>
            ${mxGraphModel.innerHTML}
          </root>
        </mxGraphModel>
      </diagram>
    </mxfile>
  `;
  
  return xmlDoc;
}
```

### 8.4 高度な機能

#### インポート・エクスポート
| 機能 | 説明 | 対応形式 |
|------|------|----------|
| **ワンクリック変換** | PlantUMLから即座にdraw.io形式に変換 | .drawio, .xml |
| **バッチ変換** | 複数のPlantUMLファイルを一括変換 | ZIP形式対応 |
| **差分変換** | PlantUMLの変更を既存draw.ioファイルに反映 | 増分更新 |
| **リバース変換** | draw.io XMLからPlantUMLへの逆変換 | 実験的機能 |

#### 品質保証
| 機能 | 説明 | 検証内容 |
|------|------|----------|
| **構文検証** | 生成されたXMLの妥当性確認 | mxGraph スキーマ検証 |
| **視覚検証** | 変換前後での意味的整合性確認 | 要素数・接続数の一致 |
| **レンダリング確認** | draw.ioでの表示確認 | プレビュー機能 |
| **エラー報告** | 変換失敗時の詳細レポート | ログ出力とユーザー通知 |

### 8.5 ユーザーインターフェース

#### 変換操作フロー
1. **変換ボタン**: PlantUML表示エリアに「draw.ioで開く」ボタン配置
2. **プログレス表示**: 変換処理の進捗をプログレスバーで表示
3. **プレビュー機能**: 変換後の大まかな見た目を事前確認
4. **ダウンロード**: .drawioファイルとしてダウンロード
5. **直接起動**: draw.ioを新しいタブで開いて編集開始

#### 設定パネル
| 設定項目 | 説明 | 選択肢 |
|----------|------|--------|
| **レイアウト方向** | 図の配置方向 | 左→右, 上→下, 自動 |
| **要素間隔** | 要素間の間隔設定 | 狭い/標準/広い |
| **カラーテーマ** | 色合いの選択 | モノクロ/カラフル/企業色 |
| **フォントサイズ** | テキストサイズ | 小/中/大 |

### 8.6 ユーザーメリットと活用シーン

#### 主要メリット
1. **再編集可能**: draw.ioで細かい調整が可能
2. **チーム共有**: 多くの企業で標準ツールとして採用済み
3. **豊富な出力形式**: draw.ioから各種形式でエクスポート可能
4. **既存ワークフローとの統合**: 既存の資料作成フローに組み込み易い

#### 典型的な活用シーン

##### 営業・提案業務
```
シーン: 顧客向け提案資料作成
1. 日本語で要件を入力
2. PlantUMLで大まかな図を確認
3. draw.io形式でエクスポート
4. draw.ioで顧客企業ロゴ・色味を調整
5. PowerPointに貼り付けて提案資料完成
```

##### システム設計・開発
```
シーン: 設計書作成からチームレビューまで
1. 設計内容を日本語で記述
2. PlantUMLで技術的妥当性を確認
3. draw.io形式でエクスポート
4. チームメンバーがdraw.ioで協同編集
5. 最終的な設計書に統合
```

##### プロジェクト管理
```
シーン: ステークホルダー向け進捗報告
1. 現在の業務フローを日本語で記述
2. PlantUMLで全体像を把握
3. draw.io形式でエクスポート  
4. draw.ioで進捗状況を色分け表示
5. 会議資料として活用
```

---

## 🔒 セキュリティ・プライバシー

### データの扱い
- **ローカル完結**: 入力データはブラウザ内のみで処理
- **外部送信**: Kroki APIへの図生成リクエストのみ（draw.io変換はローカル処理）
- **個人情報**: 収集・保存しない

### セキュリティ対策
- **XSS対策**: 入力値のサニタイゼーション
- **CSP設定**: Content Security Policy適用
- **HTTPS必須**: 全通信をSSL/TLS暗号化

---

## 📌 まとめ

このアプリは**「日本語を書くだけで図が作れる」**という、シンプルだが強力なコンセプトを実現します。

特に**運用が固まっていない段階**でも使えることが最大の特徴で、議論を活性化し、認識のズレを防ぎます。

### 成功の定義
- **技術的成功**: 90%以上の変換成功率
- **ビジネス成功**: 業務効率20%向上
- **ユーザー成功**: NPS 50以上

### 差別化ポイント
1. **日本語特化**: 日本のビジネス文書に最適化
2. **EC/SaaS特化**: 業界特有の用語・フローに対応
3. **初心者配慮**: 図解経験ゼロでも使える

図解の専門知識は不要。**あなたの言葉が、そのまま図になります。**

---

## 📎 付録A: サンプル集

### 基本的な業務フロー
```text
顧客がECに見積依頼を送る
ECが顧客に見積結果を通知
顧客がECに注文確定を送る
ECが契約に作成を依頼
契約がECに完了を通知
```

### 未確定要素を含むフロー
```text
顧客がECに見積依頼を送る
ECが与信チェック？
案A: 自動承認で進む
案B: 営業確認が必要
顧客に見積を送付
```

### 詳細な作業手順
```text
見積依頼を受付
商品情報を確認
価格計算を実行
割引条件を適用
条件: 金額 > 100万 -> 上長承認 / それ以外 -> 自動承認
見積書を生成
顧客に送付
```

### draw.io連携の例
```text
# 入力（日本語）
顧客がECに見積依頼を送る
ECが顧客に見積結果を通知

# 出力1（PlantUML）- 自動生成
@startuml
participant 顧客
participant EC
顧客 -> EC: 見積依頼
EC -> 顧客: 見積結果
@enduml

# 出力2（draw.io XML）- PlantUMLから変換
<mxfile>
  <diagram>
    <mxGraphModel>
      <!-- 自動的にグリッドスナップ済み -->
      <!-- 接続ポイント固定済み -->
      <!-- 編集可能な形式 -->
    </mxGraphModel>
  </diagram>
</mxfile>
```

---

## 📎 付録B: 機能一覧（開発者向け）

### 機能ID一覧（更新版）
| カテゴリ | 機能ID範囲 | 機能数 | 新機能 |
|----------|------------|--------|--------|
| 入力・変換 | F001-F012 | 12 | - |
| UI/UX | F013-F024 | 12 | - |
| 初心者サポート | F025-F036 | 12 | - |
| データ管理 | F037-F044 | 8 | - |
| 出力・共有 | F045-F055 | 11 | - |
| **注釈機能** | **F056-F070** | **15** | **✨新規** |
| **画像解析機能** | **F071-F085** | **15** | **✨新規** |
| **draw.io連携強化** | **F086-F095** | **10** | **✨新規** |
| **合計** | | **95機能** | **+40機能** |

### 新機能詳細
#### 注釈機能（F056-F070）
- F056: ペンツール描画
- F057: 矢印ツール描画
- F058: テキストツール
- F059: 消しゴムツール
- F060: 色・線幅設定
- F061: レイヤー管理
- F062: 座標同期
- F063: 注釈データ永続化
- F064: 元に戻す・全消去
- F065: 注釈付き画像エクスポート
- F066: タッチデバイス対応
- F067: 高DPI対応
- F068: 印刷対応
- F069: 注釈データ import/export
- F070: リアルタイム描画最適化

#### 画像解析機能（F071-F085）
- F071: OCR（日本語・英語）
- F072: 画像前処理
- F073: パターン認識
- F074: 図種自動判定
- F075: PlantUMLコード自動生成
- F076: ドラッグ&ドロップ
- F077: ファイル形式検証
- F078: 解析結果編集UI
- F079: プレビュー機能
- F080: バッチ処理
- F081: クリップボード対応
- F082: カメラ撮影連携
- F083: 解析精度向上
- F084: エラーハンドリング
- F085: メモリ管理

#### draw.io連携強化（F086-F095）
- F086: 高度なXML変換
- F087: スタイル保持
- F088: グリッドスナップ
- F089: レイアウト最適化
- F090: バッチ変換
- F091: 差分変換
- F092: 品質検証
- F093: エラー報告
- F094: プレビュー機能
- F095: 設定カスタマイズ

### 優先度別集計（更新版）
| 優先度 | 機能数 | Phase | 内訳 |
|--------|--------|-------|------|
| 必須 | 35 | Phase 1-2 | 既存20 + 新機能15 |
| 高 | 25 | Phase 2-3 | 既存15 + 新機能10 |
| 中 | 25 | Phase 3-4 | 既存15 + 新機能10 |
| 低 | 10 | Phase 4+ | 既存5 + 新機能5 |
| **合計** | **95** | | **既存55 + 新機能40** |

---

## 📎 付録C: 用語集（拡張版）

### 基本技術用語
| 用語 | 説明 |
|------|------|
| **PlantUML** | テキストベースの図記述言語 |
| **シーケンス図** | 処理の流れを時系列で表現する図 |
| **活動図** | 作業手順やワークフローを表現する図 |
| **クラス図** | データ構造や関係を表現する図 |
| **ガント図** | スケジュールを時間軸で表現する図 |
| **状態遷移図** | システムの状態変化を表現する図 |
| **ユースケース図** | システムの機能と利用者の関係を表現する図 |
| **Kroki** | 各種図記述言語をレンダリングするAPI |
| **LocalStorage** | ブラウザのローカルデータ保存領域 |
| **パーマリンク** | 永続的にアクセス可能なURL |

### 注釈機能関連
| 用語 | 説明 |
|------|------|
| **Canvas API** | HTML5でグラフィック描画を行うためのAPI |
| **ペンツール** | 自由曲線を描画するための注釈ツール |
| **矢印ツール** | 直線矢印を描画するための注釈ツール |
| **消しゴムツール** | 描画済み注釈を削除するためのツール |
| **レイヤー** | 図の上に重ね合わせる描画領域 |
| **座標同期** | SVG要素とCanvas要素の位置を合わせる機能 |
| **高DPI対応** | Retina等の高解像度ディスプレイでの最適表示 |

### 画像解析機能関連
| 用語 | 説明 |
|------|------|
| **OCR** | Optical Character Recognition（光学文字認識） |
| **Tesseract.js** | ブラウザで動作するOCRライブラリ |
| **パターン認識** | 画像から図形・構造を自動検出する技術 |
| **エッジ検出** | 画像の境界線を抽出する画像処理技術 |
| **二値化** | 画像を白黒の2色に変換する前処理 |
| **ノイズ除去** | 画像の不要なノイズを取り除く処理 |
| **図種判定** | 画像の内容から図表の種類を自動判別する機能 |
| **Web Worker** | メインスレッドをブロックしない非同期処理 |

### draw.io連携関連
| 用語 | 説明 |
|------|------|
| **draw.io** | オンライン図表作成ツール（現diagrams.net） |
| **mxGraph** | draw.ioが使用する図表描画ライブラリ |
| **XML変換** | PlantUMLコードをdraw.io形式に変換する処理 |
| **グリッドスナップ** | 要素を格子点に自動配置する機能 |
| **スタイル保持** | 色・線幅・フォント等の見た目情報の維持 |
| **自動レイアウト** | 要素を適切な位置に自動配置する機能 |
| **差分変換** | 変更部分のみを更新する効率的な変換方式 |

---

*最終更新: 2025年8月9日*  
*バージョン: 2.0* - 注釈機能・画像解析機能・draw.io連携強化を追加